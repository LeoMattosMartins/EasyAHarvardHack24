/*! For license information please see index.js.LICENSE.txt */
!function(t,e){"object"==typeof exports&&"object"==typeof module?module.exports=e():"function"==typeof define&&define.amd?define([],e):"object"==typeof exports?exports.StacksBns=e():t.StacksBns=e()}(this,(()=>(()=>{var t,e,n={525:(t,e)=>{"use strict";function n(t){if(!Number.isSafeInteger(t)||t<0)throw new Error(`Wrong positive integer: ${t}`)}function r(t){if("boolean"!=typeof t)throw new Error(`Expected boolean, not ${t}`)}function i(t,...e){if(!(t instanceof Uint8Array))throw new TypeError("Expected Uint8Array");if(e.length>0&&!e.includes(t.length))throw new TypeError(`Expected Uint8Array of length ${e}, not of length=${t.length}`)}function o(t){if("function"!=typeof t||"function"!=typeof t.create)throw new Error("Hash should be wrapped by utils.wrapConstructor");n(t.outputLen),n(t.blockLen)}function s(t,e=!0){if(t.destroyed)throw new Error("Hash instance has been destroyed");if(e&&t.finished)throw new Error("Hash#digest() has already been called")}function a(t,e){i(t);const n=e.outputLen;if(t.length<n)throw new Error(`digestInto() expects output buffer of length at least ${n}`)}Object.defineProperty(e,"__esModule",{value:!0}),e.output=e.exists=e.hash=e.bytes=e.bool=e.number=void 0,e.number=n,e.bool=r,e.bytes=i,e.hash=o,e.exists=s,e.output=a;const c={number:n,bool:r,bytes:i,hash:o,exists:s,output:a};e.default=c},350:(t,e,n)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.SHA2=void 0;const r=n(525),i=n(64);class o extends i.Hash{constructor(t,e,n,r){super(),this.blockLen=t,this.outputLen=e,this.padOffset=n,this.isLE=r,this.finished=!1,this.length=0,this.pos=0,this.destroyed=!1,this.buffer=new Uint8Array(t),this.view=(0,i.createView)(this.buffer)}update(t){r.default.exists(this);const{view:e,buffer:n,blockLen:o}=this,s=(t=(0,i.toBytes)(t)).length;for(let r=0;r<s;){const a=Math.min(o-this.pos,s-r);if(a!==o)n.set(t.subarray(r,r+a),this.pos),this.pos+=a,r+=a,this.pos===o&&(this.process(e,0),this.pos=0);else{const e=(0,i.createView)(t);for(;o<=s-r;r+=o)this.process(e,r)}}return this.length+=t.length,this.roundClean(),this}digestInto(t){r.default.exists(this),r.default.output(t,this),this.finished=!0;const{buffer:e,view:n,blockLen:o,isLE:s}=this;let{pos:a}=this;e[a++]=128,this.buffer.subarray(a).fill(0),this.padOffset>o-a&&(this.process(n,0),a=0);for(let t=a;t<o;t++)e[t]=0;!function(t,e,n,r){if("function"==typeof t.setBigUint64)return t.setBigUint64(e,n,r);const i=BigInt(32),o=BigInt(4294967295),s=Number(n>>i&o),a=Number(n&o),c=r?4:0,u=r?0:4;t.setUint32(e+c,s,r),t.setUint32(e+u,a,r)}(n,o-8,BigInt(8*this.length),s),this.process(n,0);const c=(0,i.createView)(t),u=this.outputLen;if(u%4)throw new Error("_sha2: outputLen should be aligned to 32bit");const f=u/4,h=this.get();if(f>h.length)throw new Error("_sha2: outputLen bigger than state");for(let t=0;t<f;t++)c.setUint32(4*t,h[t],s)}digest(){const{buffer:t,outputLen:e}=this;this.digestInto(t);const n=t.slice(0,e);return this.destroy(),n}_cloneInto(t){t||(t=new this.constructor),t.set(...this.get());const{blockLen:e,buffer:n,length:r,finished:i,destroyed:o,pos:s}=this;return t.length=r,t.pos=s,t.finished=i,t.destroyed=o,r%e&&t.buffer.set(n),t}}e.SHA2=o},661:(t,e)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.crypto=void 0,e.crypto={node:void 0,web:"object"==typeof self&&"crypto"in self?self.crypto:void 0}},53:(t,e,n)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.sha224=e.sha256=void 0;const r=n(350),i=n(64),o=(t,e,n)=>t&e^t&n^e&n,s=new Uint32Array([1116352408,1899447441,3049323471,3921009573,961987163,1508970993,2453635748,2870763221,3624381080,310598401,607225278,1426881987,1925078388,2162078206,2614888103,3248222580,3835390401,4022224774,264347078,604807628,770255983,1249150122,1555081692,1996064986,2554220882,2821834349,2952996808,3210313671,3336571891,3584528711,113926993,338241895,666307205,773529912,1294757372,1396182291,1695183700,1986661051,2177026350,2456956037,2730485921,2820302411,3259730800,3345764771,3516065817,3600352804,4094571909,275423344,430227734,506948616,659060556,883997877,958139571,1322822218,1537002063,1747873779,1955562222,2024104815,2227730452,2361852424,2428436474,2756734187,3204031479,3329325298]),a=new Uint32Array([1779033703,3144134277,1013904242,2773480762,1359893119,2600822924,528734635,1541459225]),c=new Uint32Array(64);class u extends r.SHA2{constructor(){super(64,32,8,!1),this.A=0|a[0],this.B=0|a[1],this.C=0|a[2],this.D=0|a[3],this.E=0|a[4],this.F=0|a[5],this.G=0|a[6],this.H=0|a[7]}get(){const{A:t,B:e,C:n,D:r,E:i,F:o,G:s,H:a}=this;return[t,e,n,r,i,o,s,a]}set(t,e,n,r,i,o,s,a){this.A=0|t,this.B=0|e,this.C=0|n,this.D=0|r,this.E=0|i,this.F=0|o,this.G=0|s,this.H=0|a}process(t,e){for(let n=0;n<16;n++,e+=4)c[n]=t.getUint32(e,!1);for(let t=16;t<64;t++){const e=c[t-15],n=c[t-2],r=(0,i.rotr)(e,7)^(0,i.rotr)(e,18)^e>>>3,o=(0,i.rotr)(n,17)^(0,i.rotr)(n,19)^n>>>10;c[t]=o+c[t-7]+r+c[t-16]|0}let{A:n,B:r,C:a,D:u,E:f,F:h,G:l,H:d}=this;for(let t=0;t<64;t++){const e=d+((0,i.rotr)(f,6)^(0,i.rotr)(f,11)^(0,i.rotr)(f,25))+((p=f)&h^~p&l)+s[t]+c[t]|0,y=((0,i.rotr)(n,2)^(0,i.rotr)(n,13)^(0,i.rotr)(n,22))+o(n,r,a)|0;d=l,l=h,h=f,f=u+e|0,u=a,a=r,r=n,n=e+y|0}var p;n=n+this.A|0,r=r+this.B|0,a=a+this.C|0,u=u+this.D|0,f=f+this.E|0,h=h+this.F|0,l=l+this.G|0,d=d+this.H|0,this.set(n,r,a,u,f,h,l,d)}roundClean(){c.fill(0)}destroy(){this.set(0,0,0,0,0,0,0,0),this.buffer.fill(0)}}class f extends u{constructor(){super(),this.A=-1056596264,this.B=914150663,this.C=812702999,this.D=-150054599,this.E=-4191439,this.F=1750603025,this.G=1694076839,this.H=-1090891868,this.outputLen=28}}e.sha256=(0,i.wrapConstructor)((()=>new u)),e.sha224=(0,i.wrapConstructor)((()=>new f))},64:(t,e,n)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.randomBytes=e.wrapConstructorWithOpts=e.wrapConstructor=e.checkOpts=e.Hash=e.concatBytes=e.toBytes=e.utf8ToBytes=e.asyncLoop=e.nextTick=e.hexToBytes=e.bytesToHex=e.isLE=e.rotr=e.createView=e.u32=e.u8=void 0;const r=n(661);if(e.u8=t=>new Uint8Array(t.buffer,t.byteOffset,t.byteLength),e.u32=t=>new Uint32Array(t.buffer,t.byteOffset,Math.floor(t.byteLength/4)),e.createView=t=>new DataView(t.buffer,t.byteOffset,t.byteLength),e.rotr=(t,e)=>t<<32-e|t>>>e,e.isLE=68===new Uint8Array(new Uint32Array([287454020]).buffer)[0],!e.isLE)throw new Error("Non little-endian hardware is not supported");const i=Array.from({length:256},((t,e)=>e.toString(16).padStart(2,"0")));function o(t){if("string"!=typeof t)throw new TypeError("utf8ToBytes expected string, got "+typeof t);return(new TextEncoder).encode(t)}function s(t){if("string"==typeof t&&(t=o(t)),!(t instanceof Uint8Array))throw new TypeError(`Expected input type is Uint8Array (got ${typeof t})`);return t}e.bytesToHex=function(t){if(!(t instanceof Uint8Array))throw new Error("Uint8Array expected");let e="";for(let n=0;n<t.length;n++)e+=i[t[n]];return e},e.hexToBytes=function(t){if("string"!=typeof t)throw new TypeError("hexToBytes: expected string, got "+typeof t);if(t.length%2)throw new Error("hexToBytes: received invalid unpadded hex");const e=new Uint8Array(t.length/2);for(let n=0;n<e.length;n++){const r=2*n,i=t.slice(r,r+2),o=Number.parseInt(i,16);if(Number.isNaN(o)||o<0)throw new Error("Invalid byte sequence");e[n]=o}return e},e.nextTick=async()=>{},e.asyncLoop=async function(t,n,r){let i=Date.now();for(let o=0;o<t;o++){r(o);const t=Date.now()-i;t>=0&&t<n||(await(0,e.nextTick)(),i+=t)}},e.utf8ToBytes=o,e.toBytes=s,e.concatBytes=function(...t){if(!t.every((t=>t instanceof Uint8Array)))throw new Error("Uint8Array list expected");if(1===t.length)return t[0];const e=t.reduce(((t,e)=>t+e.length),0),n=new Uint8Array(e);for(let e=0,r=0;e<t.length;e++){const i=t[e];n.set(i,r),r+=i.length}return n},e.Hash=class{clone(){return this._cloneInto()}},e.checkOpts=function(t,e){if(void 0!==e&&("object"!=typeof e||(n=e,"[object Object]"!==Object.prototype.toString.call(n)||n.constructor!==Object)))throw new TypeError("Options should be object or undefined");var n;return Object.assign(t,e)},e.wrapConstructor=function(t){const e=e=>t().update(s(e)).digest(),n=t();return e.outputLen=n.outputLen,e.blockLen=n.blockLen,e.create=()=>t(),e},e.wrapConstructorWithOpts=function(t){const e=(e,n)=>t(n).update(s(e)).digest(),n=t({});return e.outputLen=n.outputLen,e.blockLen=n.blockLen,e.create=e=>t(e),e},e.randomBytes=function(t=32){if(r.crypto.web)return r.crypto.web.getRandomValues(new Uint8Array(t));if(r.crypto.node)return new Uint8Array(r.crypto.node.randomBytes(t).buffer);throw new Error("The environment doesn't have randomBytes function")}},166:t=>{"use strict";t.exports=function(t){if(t.length>=255)throw new TypeError("Alphabet too long");for(var e=new Uint8Array(256),n=0;n<e.length;n++)e[n]=255;for(var r=0;r<t.length;r++){var i=t.charAt(r),o=i.charCodeAt(0);if(255!==e[o])throw new TypeError(i+" is ambiguous");e[o]=r}var s=t.length,a=t.charAt(0),c=Math.log(s)/Math.log(256),u=Math.log(256)/Math.log(s);function f(t){if("string"!=typeof t)throw new TypeError("Expected String");if(0===t.length)return new Uint8Array;for(var n=0,r=0,i=0;t[n]===a;)r++,n++;for(var o=(t.length-n)*c+1>>>0,u=new Uint8Array(o);t[n];){var f=e[t.charCodeAt(n)];if(255===f)return;for(var h=0,l=o-1;(0!==f||h<i)&&-1!==l;l--,h++)f+=s*u[l]>>>0,u[l]=f%256>>>0,f=f/256>>>0;if(0!==f)throw new Error("Non-zero carry");i=h,n++}for(var d=o-i;d!==o&&0===u[d];)d++;for(var p=new Uint8Array(r+(o-d)),y=r;d!==o;)p[y++]=u[d++];return p}return{encode:function(e){if(e instanceof Uint8Array||(ArrayBuffer.isView(e)?e=new Uint8Array(e.buffer,e.byteOffset,e.byteLength):Array.isArray(e)&&(e=Uint8Array.from(e))),!(e instanceof Uint8Array))throw new TypeError("Expected Uint8Array");if(0===e.length)return"";for(var n=0,r=0,i=0,o=e.length;i!==o&&0===e[i];)i++,n++;for(var c=(o-i)*u+1>>>0,f=new Uint8Array(c);i!==o;){for(var h=e[i],l=0,d=c-1;(0!==h||l<r)&&-1!==d;d--,l++)h+=256*f[d]>>>0,f[d]=h%s>>>0,h=h/s>>>0;if(0!==h)throw new Error("Non-zero carry");r=l,i++}for(var p=c-r;p!==c&&0===f[p];)p++;for(var y=a.repeat(n);p<c;++p)y+=t.charAt(f[p]);return y},decodeUnsafe:f,decode:function(t){var e=f(t);if(e)return e;throw new Error("Non-base"+s+" character")}}}},98:(t,e,n)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.c32ToB58=e.b58ToC32=e.c32addressDecode=e.c32address=e.versions=void 0;const r=n(392),i=n(716),o=n(64);e.versions={mainnet:{p2pkh:22,p2sh:20},testnet:{p2pkh:26,p2sh:21}};const s={};s[0]=e.versions.mainnet.p2pkh,s[5]=e.versions.mainnet.p2sh,s[111]=e.versions.testnet.p2pkh,s[196]=e.versions.testnet.p2sh;const a={};function c(t,e){if(!e.match(/^[0-9a-fA-F]{40}$/))throw new Error("Invalid argument: not a hash160 hex string");return`S${(0,r.c32checkEncode)(t,e)}`}function u(t){if(t.length<=5)throw new Error("Invalid c32 address: invalid length");if("S"!=t[0])throw new Error('Invalid c32 address: must start with "S"');return(0,r.c32checkDecode)(t.slice(1))}a[e.versions.mainnet.p2pkh]=0,a[e.versions.mainnet.p2sh]=5,a[e.versions.testnet.p2pkh]=111,a[e.versions.testnet.p2sh]=196,e.c32address=c,e.c32addressDecode=u,e.b58ToC32=function(t,e=-1){const n=i.decode(t),r=(0,o.bytesToHex)(n.data),a=parseInt((0,o.bytesToHex)(n.prefix),16);let u;return e<0?(u=a,void 0!==s[a]&&(u=s[a])):u=e,c(u,r)},e.c32ToB58=function(t,e=-1){const n=u(t),r=n[0],o=n[1];let s;e<0?(s=r,void 0!==a[r]&&(s=a[r])):s=e;let c=s.toString(16);return 1===c.length&&(c=`0${c}`),i.encode(o,c)}},716:(t,e,n)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.decode=e.encode=void 0;const r=n(53),i=n(64),o=n(166),s="123456789ABCDEFGHJKLMNPQRSTUVWXYZabcdefghijkmnopqrstuvwxyz";e.encode=function(t,e="00"){const n="string"==typeof t?(0,i.hexToBytes)(t):t,a="string"==typeof e?(0,i.hexToBytes)(e):t;if(!(n instanceof Uint8Array&&a instanceof Uint8Array))throw new TypeError("Argument must be of type Uint8Array or string");const c=(0,r.sha256)((0,r.sha256)(new Uint8Array([...a,...n])));return o(s).encode([...a,...n,...c.slice(0,4)])},e.decode=function(t){const e=o(s).decode(t),n=e.slice(0,1),i=e.slice(1,-4),a=(0,r.sha256)((0,r.sha256)(new Uint8Array([...n,...i])));return e.slice(-4).forEach(((t,e)=>{if(t!==a[e])throw new Error("Invalid checksum")})),{prefix:n,data:i}}},392:(t,e,n)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.c32checkDecode=e.c32checkEncode=void 0;const r=n(53),i=n(64),o=n(103);function s(t){const e=(0,r.sha256)((0,r.sha256)((0,i.hexToBytes)(t)));return(0,i.bytesToHex)(e.slice(0,4))}e.c32checkEncode=function(t,e){if(t<0||t>=32)throw new Error("Invalid version (must be between 0 and 31)");if(!e.match(/^[0-9a-fA-F]*$/))throw new Error("Invalid data (not a hex string)");(e=e.toLowerCase()).length%2!=0&&(e=`0${e}`);let n=t.toString(16);1===n.length&&(n=`0${n}`);const r=s(`${n}${e}`),i=(0,o.c32encode)(`${e}${r}`);return`${o.c32[t]}${i}`},e.c32checkDecode=function(t){t=(0,o.c32normalize)(t);const e=(0,o.c32decode)(t.slice(1)),n=t[0],r=o.c32.indexOf(n),i=e.slice(-8);let a=r.toString(16);if(1===a.length&&(a=`0${a}`),s(`${a}${e.substring(0,e.length-8)}`)!==i)throw new Error("Invalid c32check string: checksum mismatch");return[r,e.substring(0,e.length-8)]}},103:(t,e,n)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.c32decode=e.c32normalize=e.c32encode=e.c32=void 0;const r=n(64);e.c32="0123456789ABCDEFGHJKMNPQRSTVWXYZ";const i="0123456789abcdef";function o(t){return t.toUpperCase().replace(/O/g,"0").replace(/L|I/g,"1")}e.c32encode=function(t,n){if(!t.match(/^[0-9a-fA-F]*$/))throw new Error("Not a hex-encoded string");t.length%2!=0&&(t=`0${t}`);let o=[],s=0;for(let n=(t=t.toLowerCase()).length-1;n>=0;n--)if(s<4){const r=i.indexOf(t[n])>>s;let a=0;0!==n&&(a=i.indexOf(t[n-1]));const c=1+s,u=a%(1<<c)<<5-c,f=e.c32[r+u];s=c,o.unshift(f)}else s=0;let a=0;for(let t=0;t<o.length&&"0"===o[t];t++)a++;o=o.slice(a);const c=(new TextDecoder).decode((0,r.hexToBytes)(t)).match(/^\u0000*/),u=c?c[0].length:0;for(let t=0;t<u;t++)o.unshift(e.c32[0]);if(n){const t=n-o.length;for(let n=0;n<t;n++)o.unshift(e.c32[0])}return o.join("")},e.c32normalize=o,e.c32decode=function(t,n){if(!(t=o(t)).match(`^[${e.c32}]*$`))throw new Error("Not a c32-encoded string");const r=t.match(`^${e.c32[0]}*`),s=r?r[0].length:0;let a=[],c=0,u=0;for(let n=t.length-1;n>=0;n--){4===u&&(a.unshift(i[c]),u=0,c=0);const r=(e.c32.indexOf(t[n])<<u)+c,o=i[r%16];if(u+=1,c=r>>4,c>1<<u)throw new Error("Panic error in decoding.");a.unshift(o)}a.unshift(i[c]),a.length%2==1&&a.unshift("0");let f=0;for(let t=0;t<a.length&&"0"===a[t];t++)f++;a=a.slice(f-f%2);let h=a.join("");for(let t=0;t<s;t++)h=`00${h}`;if(n){const t=2*n-h.length;for(let e=0;e<t;e+=2)h=`00${h}`}return h}},870:(t,e,n)=>{"use strict";e.yI=e.H4=void 0;n(103),n(392);const r=n(98);Object.defineProperty(e,"H4",{enumerable:!0,get:function(){return r.c32address}}),Object.defineProperty(e,"yI",{enumerable:!0,get:function(){return r.c32addressDecode}})},907:(t,e,n)=>{t=n.nmd(t);var r="__lodash_hash_undefined__",i=9007199254740991,o="[object Arguments]",s="[object Boolean]",a="[object Date]",c="[object Function]",u="[object GeneratorFunction]",f="[object Map]",h="[object Number]",l="[object Object]",d="[object Promise]",p="[object RegExp]",y="[object Set]",g="[object String]",b="[object Symbol]",w="[object WeakMap]",m="[object ArrayBuffer]",v="[object DataView]",A="[object Float32Array]",x="[object Float64Array]",S="[object Int8Array]",E="[object Int16Array]",C="[object Int32Array]",B="[object Uint8Array]",T="[object Uint8ClampedArray]",I="[object Uint16Array]",U="[object Uint32Array]",k=/\w*$/,P=/^\[object .+?Constructor\]$/,N=/^(?:0|[1-9]\d*)$/,$={};$[o]=$["[object Array]"]=$[m]=$[v]=$[s]=$[a]=$[A]=$[x]=$[S]=$[E]=$[C]=$[f]=$[h]=$[l]=$[p]=$[y]=$[g]=$[b]=$[B]=$[T]=$[I]=$[U]=!0,$["[object Error]"]=$[c]=$[w]=!1;var O="object"==typeof n.g&&n.g&&n.g.Object===Object&&n.g,H="object"==typeof self&&self&&self.Object===Object&&self,_=O||H||Function("return this")(),L=e&&!e.nodeType&&e,j=L&&t&&!t.nodeType&&t,M=j&&j.exports===L;function F(t,e){return t.set(e[0],e[1]),t}function R(t,e){return t.add(e),t}function D(t,e,n,r){var i=-1,o=t?t.length:0;for(r&&o&&(n=t[++i]);++i<o;)n=e(n,t[i],i,t);return n}function K(t){var e=!1;if(null!=t&&"function"!=typeof t.toString)try{e=!!(t+"")}catch(t){}return e}function V(t){var e=-1,n=Array(t.size);return t.forEach((function(t,r){n[++e]=[r,t]})),n}function z(t,e){return function(n){return t(e(n))}}function q(t){var e=-1,n=Array(t.size);return t.forEach((function(t){n[++e]=t})),n}var W,G=Array.prototype,Z=Function.prototype,X=Object.prototype,J=_["__core-js_shared__"],Q=(W=/[^.]+$/.exec(J&&J.keys&&J.keys.IE_PROTO||""))?"Symbol(src)_1."+W:"",Y=Z.toString,tt=X.hasOwnProperty,et=X.toString,nt=RegExp("^"+Y.call(tt).replace(/[\\^$.*+?()[\]{}|]/g,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$"),rt=M?_.Buffer:void 0,it=_.Symbol,ot=_.Uint8Array,st=z(Object.getPrototypeOf,Object),at=Object.create,ct=X.propertyIsEnumerable,ut=G.splice,ft=Object.getOwnPropertySymbols,ht=rt?rt.isBuffer:void 0,lt=z(Object.keys,Object),dt=_t(_,"DataView"),pt=_t(_,"Map"),yt=_t(_,"Promise"),gt=_t(_,"Set"),bt=_t(_,"WeakMap"),wt=_t(Object,"create"),mt=Rt(dt),vt=Rt(pt),At=Rt(yt),xt=Rt(gt),St=Rt(bt),Et=it?it.prototype:void 0,Ct=Et?Et.valueOf:void 0;function Bt(t){var e=-1,n=t?t.length:0;for(this.clear();++e<n;){var r=t[e];this.set(r[0],r[1])}}function Tt(t){var e=-1,n=t?t.length:0;for(this.clear();++e<n;){var r=t[e];this.set(r[0],r[1])}}function It(t){var e=-1,n=t?t.length:0;for(this.clear();++e<n;){var r=t[e];this.set(r[0],r[1])}}function Ut(t){this.__data__=new Tt(t)}function kt(t,e,n){var r=t[e];tt.call(t,e)&&Dt(r,n)&&(void 0!==n||e in t)||(t[e]=n)}function Pt(t,e){for(var n=t.length;n--;)if(Dt(t[n][0],e))return n;return-1}function Nt(t,e,n,r,i,d,w){var P;if(r&&(P=d?r(t,i,d,w):r(t)),void 0!==P)return P;if(!Wt(t))return t;var N=Kt(t);if(N){if(P=function(t){var e=t.length,n=t.constructor(e);return e&&"string"==typeof t[0]&&tt.call(t,"index")&&(n.index=t.index,n.input=t.input),n}(t),!e)return function(t,e){var n=-1,r=t.length;for(e||(e=Array(r));++n<r;)e[n]=t[n];return e}(t,P)}else{var O=jt(t),H=O==c||O==u;if(zt(t))return function(t,e){if(e)return t.slice();var n=new t.constructor(t.length);return t.copy(n),n}(t,e);if(O==l||O==o||H&&!d){if(K(t))return d?t:{};if(P=function(t){return"function"!=typeof t.constructor||Ft(t)?{}:Wt(e=st(t))?at(e):{};var e}(H?{}:t),!e)return function(t,e){return Ot(t,Lt(t),e)}(t,function(t,e){return t&&Ot(e,Gt(e),t)}(P,t))}else{if(!$[O])return d?t:{};P=function(t,e,n,r){var i,o=t.constructor;switch(e){case m:return $t(t);case s:case a:return new o(+t);case v:return function(t,e){var n=e?$t(t.buffer):t.buffer;return new t.constructor(n,t.byteOffset,t.byteLength)}(t,r);case A:case x:case S:case E:case C:case B:case T:case I:case U:return function(t,e){var n=e?$t(t.buffer):t.buffer;return new t.constructor(n,t.byteOffset,t.length)}(t,r);case f:return function(t,e,n){return D(e?n(V(t),!0):V(t),F,new t.constructor)}(t,r,n);case h:case g:return new o(t);case p:return function(t){var e=new t.constructor(t.source,k.exec(t));return e.lastIndex=t.lastIndex,e}(t);case y:return function(t,e,n){return D(e?n(q(t),!0):q(t),R,new t.constructor)}(t,r,n);case b:return i=t,Ct?Object(Ct.call(i)):{}}}(t,O,Nt,e)}}w||(w=new Ut);var _=w.get(t);if(_)return _;if(w.set(t,P),!N)var L=n?function(t){return function(t,e,n){var r=e(t);return Kt(t)?r:function(t,e){for(var n=-1,r=e.length,i=t.length;++n<r;)t[i+n]=e[n];return t}(r,n(t))}(t,Gt,Lt)}(t):Gt(t);return function(t,e){for(var n=-1,r=t?t.length:0;++n<r&&!1!==e(t[n],n););}(L||t,(function(i,o){L&&(i=t[o=i]),kt(P,o,Nt(i,e,n,r,o,t,w))})),P}function $t(t){var e=new t.constructor(t.byteLength);return new ot(e).set(new ot(t)),e}function Ot(t,e,n,r){n||(n={});for(var i=-1,o=e.length;++i<o;){var s=e[i],a=r?r(n[s],t[s],s,n,t):void 0;kt(n,s,void 0===a?t[s]:a)}return n}function Ht(t,e){var n,r,i=t.__data__;return("string"==(r=typeof(n=e))||"number"==r||"symbol"==r||"boolean"==r?"__proto__"!==n:null===n)?i["string"==typeof e?"string":"hash"]:i.map}function _t(t,e){var n=function(t,e){return null==t?void 0:t[e]}(t,e);return function(t){return!(!Wt(t)||(e=t,Q&&Q in e))&&(qt(t)||K(t)?nt:P).test(Rt(t));var e}(n)?n:void 0}Bt.prototype.clear=function(){this.__data__=wt?wt(null):{}},Bt.prototype.delete=function(t){return this.has(t)&&delete this.__data__[t]},Bt.prototype.get=function(t){var e=this.__data__;if(wt){var n=e[t];return n===r?void 0:n}return tt.call(e,t)?e[t]:void 0},Bt.prototype.has=function(t){var e=this.__data__;return wt?void 0!==e[t]:tt.call(e,t)},Bt.prototype.set=function(t,e){return this.__data__[t]=wt&&void 0===e?r:e,this},Tt.prototype.clear=function(){this.__data__=[]},Tt.prototype.delete=function(t){var e=this.__data__,n=Pt(e,t);return!(n<0||(n==e.length-1?e.pop():ut.call(e,n,1),0))},Tt.prototype.get=function(t){var e=this.__data__,n=Pt(e,t);return n<0?void 0:e[n][1]},Tt.prototype.has=function(t){return Pt(this.__data__,t)>-1},Tt.prototype.set=function(t,e){var n=this.__data__,r=Pt(n,t);return r<0?n.push([t,e]):n[r][1]=e,this},It.prototype.clear=function(){this.__data__={hash:new Bt,map:new(pt||Tt),string:new Bt}},It.prototype.delete=function(t){return Ht(this,t).delete(t)},It.prototype.get=function(t){return Ht(this,t).get(t)},It.prototype.has=function(t){return Ht(this,t).has(t)},It.prototype.set=function(t,e){return Ht(this,t).set(t,e),this},Ut.prototype.clear=function(){this.__data__=new Tt},Ut.prototype.delete=function(t){return this.__data__.delete(t)},Ut.prototype.get=function(t){return this.__data__.get(t)},Ut.prototype.has=function(t){return this.__data__.has(t)},Ut.prototype.set=function(t,e){var n=this.__data__;if(n instanceof Tt){var r=n.__data__;if(!pt||r.length<199)return r.push([t,e]),this;n=this.__data__=new It(r)}return n.set(t,e),this};var Lt=ft?z(ft,Object):function(){return[]},jt=function(t){return et.call(t)};function Mt(t,e){return!!(e=null==e?i:e)&&("number"==typeof t||N.test(t))&&t>-1&&t%1==0&&t<e}function Ft(t){var e=t&&t.constructor;return t===("function"==typeof e&&e.prototype||X)}function Rt(t){if(null!=t){try{return Y.call(t)}catch(t){}try{return t+""}catch(t){}}return""}function Dt(t,e){return t===e||t!=t&&e!=e}(dt&&jt(new dt(new ArrayBuffer(1)))!=v||pt&&jt(new pt)!=f||yt&&jt(yt.resolve())!=d||gt&&jt(new gt)!=y||bt&&jt(new bt)!=w)&&(jt=function(t){var e=et.call(t),n=e==l?t.constructor:void 0,r=n?Rt(n):void 0;if(r)switch(r){case mt:return v;case vt:return f;case At:return d;case xt:return y;case St:return w}return e});var Kt=Array.isArray;function Vt(t){return null!=t&&function(t){return"number"==typeof t&&t>-1&&t%1==0&&t<=i}(t.length)&&!qt(t)}var zt=ht||function(){return!1};function qt(t){var e=Wt(t)?et.call(t):"";return e==c||e==u}function Wt(t){var e=typeof t;return!!t&&("object"==e||"function"==e)}function Gt(t){return Vt(t)?function(t,e){var n=Kt(t)||function(t){return function(t){return function(t){return!!t&&"object"==typeof t}(t)&&Vt(t)}(t)&&tt.call(t,"callee")&&(!ct.call(t,"callee")||et.call(t)==o)}(t)?function(t,e){for(var n=-1,r=Array(t);++n<t;)r[n]=e(n);return r}(t.length,String):[],r=n.length,i=!!r;for(var s in t)!e&&!tt.call(t,s)||i&&("length"==s||Mt(s,r))||n.push(s);return n}(t):function(t){if(!Ft(t))return lt(t);var e=[];for(var n in Object(t))tt.call(t,n)&&"constructor"!=n&&e.push(n);return e}(t)}t.exports=function(t){return Nt(t,!0,!0)}},314:()=>{}},r={};function i(t){var e=r[t];if(void 0!==e)return e.exports;var o=r[t]={id:t,loaded:!1,exports:{}};return n[t](o,o.exports,i),o.loaded=!0,o.exports}i.n=t=>{var e=t&&t.__esModule?()=>t.default:()=>t;return i.d(e,{a:e}),e},e=Object.getPrototypeOf?t=>Object.getPrototypeOf(t):t=>t.__proto__,i.t=function(n,r){if(1&r&&(n=this(n)),8&r)return n;if("object"==typeof n&&n){if(4&r&&n.__esModule)return n;if(16&r&&"function"==typeof n.then)return n}var o=Object.create(null);i.r(o);var s={};t=t||[null,e({}),e([]),e(e)];for(var a=2&r&&n;"object"==typeof a&&!~t.indexOf(a);a=e(a))Object.getOwnPropertyNames(a).forEach((t=>s[t]=()=>n[t]));return s.default=()=>n,i.d(o,s),o},i.d=(t,e)=>{for(var n in e)i.o(e,n)&&!i.o(t,n)&&Object.defineProperty(t,n,{enumerable:!0,get:e[n]})},i.g=function(){if("object"==typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(t){if("object"==typeof window)return window}}(),i.o=(t,e)=>Object.prototype.hasOwnProperty.call(t,e),i.r=t=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},i.nmd=t=>(t.paths=[],t.children||(t.children=[]),t);var o={};return(()=>{"use strict";function t(t,n){return a(e(t),n)}function e(t){if("bigint"==typeof t)return t;if("string"==typeof t)return BigInt(t);if("number"==typeof t){if(!Number.isInteger(t))throw new RangeError("Invalid value. Values of type 'number' must be an integer.");if(t>Number.MAX_SAFE_INTEGER)throw new RangeError(`Invalid value. Values of type 'number' must be less than or equal to ${Number.MAX_SAFE_INTEGER}. For larger values, try using a BigInt instead.`);return BigInt(t)}if(v(t,Uint8Array))return BigInt(`0x${f(t)}`);throw new TypeError("intToBigInt: Invalid value type. Must be a number, bigint, BigInt-compatible string, or Uint8Array.")}function n(t){if("string"!=typeof t)throw new TypeError("hexToBigInt: expected string, got "+typeof t);return BigInt(`0x${t}`)}function r(t,n=8){return("bigint"==typeof t?t:e(t)).toString(16).padStart(2*n,"0")}function s(t){return parseInt(t,16)}function a(t,e=16){return h(r(t,e))}function c(t){return e=BigInt(`0x${f(t)}`),n=BigInt(8*t.byteLength),function(t,e){return t&BigInt(1)<<e}(e,n-BigInt(1))?e-(BigInt(1)<<n):e;var e,n}i.r(o),i.d(o,{BNS_CONTRACT_NAME:()=>Li,buildImportNameTx:()=>zi,buildPreorderNameTx:()=>Wi,buildPreorderNamespaceTx:()=>Ki,buildReadyNamespaceTx:()=>qi,buildRegisterNameTx:()=>Gi,buildRenewNameTx:()=>Qi,buildRevealNamespaceTx:()=>Vi,buildRevokeNameTx:()=>Ji,buildTransferNameTx:()=>Xi,buildUpdateNameTx:()=>Zi,canRegisterName:()=>Fi,getNamePrice:()=>Di,getNamespacePrice:()=>Ri});const u=Array.from({length:256},((t,e)=>e.toString(16).padStart(2,"0")));function f(t){if(!(t instanceof Uint8Array))throw new Error("Uint8Array expected");let e="";for(const n of t)e+=u[n];return e}function h(t){if("string"!=typeof t)throw new TypeError("hexToBytes: expected string, got "+typeof t);var e;t=(e=t,t=/^0x/i.test(e)?e.slice(2):e).length%2?`0${t}`:t;const n=new Uint8Array(t.length/2);for(let e=0;e<n.length;e++){const r=2*e,i=t.slice(r,r+2),o=Number.parseInt(i,16);if(Number.isNaN(o)||o<0)throw new Error("Invalid byte sequence");n[e]=o}return n}function l(t){return(new TextEncoder).encode(t)}function d(t){return(new TextDecoder).decode(t)}function p(t){const e=[];for(let n=0;n<t.length;n++)e.push(255&t.charCodeAt(n));return new Uint8Array(e)}function y(t){return String.fromCharCode.apply(null,t)}function g(t){return!Number.isInteger(t)||t<0||t>255}function b(t){if(t.some(g))throw new Error("Some values are invalid bytes.");return new Uint8Array(t)}function w(...t){if(!t.every((t=>t instanceof Uint8Array)))throw new Error("Uint8Array list expected");if(1===t.length)return t[0];const e=t.reduce(((t,e)=>t+e.length),0),n=new Uint8Array(e);for(let e=0,r=0;e<t.length;e++){const i=t[e];n.set(i,r),r+=i.length}return n}function m(t){return w(...t.map((t=>"number"==typeof t?b([t]):t instanceof Array?b(t):t)))}function v(t,e){return t instanceof e||t?.constructor?.name?.toLowerCase()===e.name}const A=33,x={referrerPolicy:"origin",headers:{"x-hiro-product":"stacksjs"}};async function S(t,e){const n={};return Object.assign(n,x,e),await fetch(t,n)}function E(...t){const{fetchLib:e,middlewares:n}=function(t){let e=S,n=[];return t.length>0&&"function"==typeof t[0]&&(e=t.shift()),t.length>0&&(n=t),{fetchLib:e,middlewares:n}}(t);return async(t,r)=>{let i={url:t,init:r??{}};for(const t of n)"function"==typeof t.pre&&(i=await Promise.resolve(t.pre({fetch:e,...i}))??i);let o=await e(i.url,i.init);for(const t of n)if("function"==typeof t.post){const n=await Promise.resolve(t.post({fetch:e,url:i.url,init:i.init,response:o?.clone()??o}));o=n??o}return o}}var C,B,T,I,U;!function(t){t[t.Mainnet=1]="Mainnet",t[t.Testnet=2147483648]="Testnet"}(C||(C={})),function(t){t[t.Mainnet=385875968]="Mainnet",t[t.Testnet=4278190080]="Testnet"}(B||(B={})),C.Mainnet,(U=T||(T={}))[U.Mainnet=0]="Mainnet",U[U.Testnet=128]="Testnet",function(t){t[t.MainnetSingleSig=22]="MainnetSingleSig",t[t.MainnetMultiSig=20]="MainnetMultiSig",t[t.TestnetSingleSig=26]="TestnetSingleSig",t[t.TestnetMultiSig=21]="TestnetMultiSig"}(I||(I={})),T.Mainnet;const k={chainId:C.Mainnet,transactionVersion:T.Mainnet,peerNetworkId:B.Mainnet,magicBytes:"X2",bootAddress:"SP000000000000000000002Q6VF78",addressVersion:{singleSig:I.MainnetSingleSig,multiSig:I.MainnetMultiSig},client:{baseUrl:"https://api.mainnet.hiro.so"}},P={chainId:C.Testnet,transactionVersion:T.Testnet,peerNetworkId:B.Testnet,magicBytes:"T2",bootAddress:"ST000000000000000000002AMW42H",addressVersion:{singleSig:I.TestnetSingleSig,multiSig:I.TestnetMultiSig},client:{baseUrl:"https://api.testnet.hiro.so"}},N={...P,addressVersion:{...P.addressVersion},magicBytes:"id",client:{baseUrl:"http://localhost:3999"}},$={...N,addressVersion:{...N.addressVersion},client:{...N.client}};function O(t){return"string"==typeof t?function(t){switch(t){case"mainnet":return k;case"testnet":return P;case"devnet":return N;case"mocknet":return $;default:throw new Error(`Unknown network name: ${t}`)}}(t):t}function H(t){return t.client.fetch?t.client:{...t.client,fetch:E()}}var _=i(870);function L(t,e,n=0){return t[n+3]=e,e>>>=8,t[n+2]=e,e>>>=8,t[n+1]=e,e>>>=8,t[n]=e,t}const j=128,M=128,F=16,R=65,D=34;var K,V,z,q,W,G;(G=K||(K={}))[G.TokenTransfer=0]="TokenTransfer",G[G.SmartContract=1]="SmartContract",G[G.VersionedSmartContract=6]="VersionedSmartContract",G[G.ContractCall=2]="ContractCall",G[G.PoisonMicroblock=3]="PoisonMicroblock",G[G.Coinbase=4]="Coinbase",G[G.CoinbaseToAltRecipient=5]="CoinbaseToAltRecipient",G[G.TenureChange=7]="TenureChange",G[G.NakamotoCoinbase=8]="NakamotoCoinbase",(W=V||(V={}))[W.Clarity1=1]="Clarity1",W[W.Clarity2=2]="Clarity2",W[W.Clarity3=3]="Clarity3",(q=z||(z={}))[q.OnChainOnly=1]="OnChainOnly",q[q.OffChainOnly=2]="OffChainOnly",q[q.Any=3]="Any";var Z,X,J,Q,Y,tt,et,nt,rt,it,ot,st,at,ct,ut,ft,ht,lt,dt,pt,yt,gt;z.OnChainOnly,z.OffChainOnly,z.Any,z.OnChainOnly,z.OnChainOnly,z.OffChainOnly,z.OffChainOnly,z.Any,z.Any,(gt=Z||(Z={}))[gt.Allow=1]="Allow",gt[gt.Deny=2]="Deny",(yt=X||(X={}))[yt.STX=0]="STX",yt[yt.Fungible=1]="Fungible",yt[yt.NonFungible=2]="NonFungible",(pt=J||(J={}))[pt.Standard=4]="Standard",pt[pt.Sponsored=5]="Sponsored",(dt=Q||(Q={}))[dt.P2PKH=0]="P2PKH",dt[dt.P2SH=1]="P2SH",dt[dt.P2WPKH=2]="P2WPKH",dt[dt.P2WSH=3]="P2WSH",dt[dt.P2SHNonSequential=5]="P2SHNonSequential",dt[dt.P2WSHNonSequential=7]="P2WSHNonSequential",(lt=Y||(Y={}))[lt.Compressed=0]="Compressed",lt[lt.Uncompressed=1]="Uncompressed",(ht=tt||(tt={}))[ht.Equal=1]="Equal",ht[ht.Greater=2]="Greater",ht[ht.GreaterEqual=3]="GreaterEqual",ht[ht.Less=4]="Less",ht[ht.LessEqual=5]="LessEqual",(ft=et||(et={}))[ft.Sends=16]="Sends",ft[ft.DoesNotSend=17]="DoesNotSend",(ut=nt||(nt={}))[ut.Origin=1]="Origin",ut[ut.Standard=2]="Standard",ut[ut.Contract=3]="Contract",function(t){t[t.STX=0]="STX",t[t.Fungible=1]="Fungible",t[t.NonFungible=2]="NonFungible"}(rt||(rt={})),(ct=it||(it={}))[ct.BlockFound=0]="BlockFound",ct[ct.Extended=1]="Extended",(at=ot||(ot={}))[at.PublicKeyCompressed=0]="PublicKeyCompressed",at[at.PublicKeyUncompressed=1]="PublicKeyUncompressed",at[at.SignatureCompressed=2]="SignatureCompressed",at[at.SignatureUncompressed=3]="SignatureUncompressed",function(t){t.Serialization="Serialization",t.Deserialization="Deserialization",t.SignatureValidation="SignatureValidation",t.FeeTooLow="FeeTooLow",t.BadNonce="BadNonce",t.NotEnoughFunds="NotEnoughFunds",t.NoSuchContract="NoSuchContract",t.NoSuchPublicFunction="NoSuchPublicFunction",t.BadFunctionArgument="BadFunctionArgument",t.ContractAlreadyExists="ContractAlreadyExists",t.PoisonMicroblocksDoNotConflict="PoisonMicroblocksDoNotConflict",t.PoisonMicroblockHasUnknownPubKeyHash="PoisonMicroblockHasUnknownPubKeyHash",t.PoisonMicroblockIsInvalid="PoisonMicroblockIsInvalid",t.BadAddressVersionByte="BadAddressVersionByte",t.NoCoinbaseViaMempool="NoCoinbaseViaMempool",t.ServerFailureNoSuchChainTip="ServerFailureNoSuchChainTip",t.ServerFailureDatabase="ServerFailureDatabase",t.ServerFailureOther="ServerFailureOther"}(st||(st={}));class bt extends Error{constructor(t){super(t),this.message=t,this.name=this.constructor.name,Error.captureStackTrace&&Error.captureStackTrace(this,this.constructor)}}class wt extends bt{constructor(t){super(t)}}class mt extends bt{constructor(t){super(t)}}class vt extends bt{constructor(t){super(t)}}class At extends bt{constructor(t){super(t)}}class xt extends bt{constructor(t){super(t)}}function St(t){if(!Number.isSafeInteger(t)||t<0)throw new Error(`Wrong positive integer: ${t}`)}function Et(t,...e){if(!(t instanceof Uint8Array))throw new TypeError("Expected Uint8Array");if(e.length>0&&!e.includes(t.length))throw new TypeError(`Expected Uint8Array of length ${e}, not of length=${t.length}`)}const Ct={number:St,bool:function(t){if("boolean"!=typeof t)throw new Error(`Expected boolean, not ${t}`)},bytes:Et,hash:function(t){if("function"!=typeof t||"function"!=typeof t.create)throw new Error("Hash should be wrapped by utils.wrapConstructor");St(t.outputLen),St(t.blockLen)},exists:function(t,e=!0){if(t.destroyed)throw new Error("Hash instance has been destroyed");if(e&&t.finished)throw new Error("Hash#digest() has already been called")},output:function(t,e){Et(t);const n=e.outputLen;if(t.length<n)throw new Error(`digestInto() expects output buffer of length at least ${n}`)}},Bt=("object"==typeof self&&"crypto"in self&&self.crypto,t=>new DataView(t.buffer,t.byteOffset,t.byteLength)),Tt=(t,e)=>t<<32-e|t>>>e;if(68!==new Uint8Array(new Uint32Array([287454020]).buffer)[0])throw new Error("Non little-endian hardware is not supported");function It(t){if("string"==typeof t&&(t=function(t){if("string"!=typeof t)throw new TypeError("utf8ToBytes expected string, got "+typeof t);return(new TextEncoder).encode(t)}(t)),!(t instanceof Uint8Array))throw new TypeError(`Expected input type is Uint8Array (got ${typeof t})`);return t}Array.from({length:256},((t,e)=>e.toString(16).padStart(2,"0")));class Ut{clone(){return this._cloneInto()}}function kt(t){const e=e=>t().update(It(e)).digest(),n=t();return e.outputLen=n.outputLen,e.blockLen=n.blockLen,e.create=()=>t(),e}class Pt extends Ut{constructor(t,e){super(),this.finished=!1,this.destroyed=!1,Ct.hash(t);const n=It(e);if(this.iHash=t.create(),"function"!=typeof this.iHash.update)throw new TypeError("Expected instance of class which extends utils.Hash");this.blockLen=this.iHash.blockLen,this.outputLen=this.iHash.outputLen;const r=this.blockLen,i=new Uint8Array(r);i.set(n.length>r?t.create().update(n).digest():n);for(let t=0;t<i.length;t++)i[t]^=54;this.iHash.update(i),this.oHash=t.create();for(let t=0;t<i.length;t++)i[t]^=106;this.oHash.update(i),i.fill(0)}update(t){return Ct.exists(this),this.iHash.update(t),this}digestInto(t){Ct.exists(this),Ct.bytes(t,this.outputLen),this.finished=!0,this.iHash.digestInto(t),this.oHash.update(t),this.oHash.digestInto(t),this.destroy()}digest(){const t=new Uint8Array(this.oHash.outputLen);return this.digestInto(t),t}_cloneInto(t){t||(t=Object.create(Object.getPrototypeOf(this),{}));const{oHash:e,iHash:n,finished:r,destroyed:i,blockLen:o,outputLen:s}=this;return t.finished=r,t.destroyed=i,t.blockLen=o,t.outputLen=s,t.oHash=e._cloneInto(t.oHash),t.iHash=n._cloneInto(t.iHash),t}destroy(){this.destroyed=!0,this.oHash.destroy(),this.iHash.destroy()}}const Nt=(t,e,n)=>new Pt(t,e).update(n).digest();Nt.create=(t,e)=>new Pt(t,e);class $t extends Ut{constructor(t,e,n,r){super(),this.blockLen=t,this.outputLen=e,this.padOffset=n,this.isLE=r,this.finished=!1,this.length=0,this.pos=0,this.destroyed=!1,this.buffer=new Uint8Array(t),this.view=Bt(this.buffer)}update(t){Ct.exists(this);const{view:e,buffer:n,blockLen:r}=this,i=(t=It(t)).length;for(let o=0;o<i;){const s=Math.min(r-this.pos,i-o);if(s!==r)n.set(t.subarray(o,o+s),this.pos),this.pos+=s,o+=s,this.pos===r&&(this.process(e,0),this.pos=0);else{const e=Bt(t);for(;r<=i-o;o+=r)this.process(e,o)}}return this.length+=t.length,this.roundClean(),this}digestInto(t){Ct.exists(this),Ct.output(t,this),this.finished=!0;const{buffer:e,view:n,blockLen:r,isLE:i}=this;let{pos:o}=this;e[o++]=128,this.buffer.subarray(o).fill(0),this.padOffset>r-o&&(this.process(n,0),o=0);for(let t=o;t<r;t++)e[t]=0;!function(t,e,n,r){if("function"==typeof t.setBigUint64)return t.setBigUint64(e,n,r);const i=BigInt(32),o=BigInt(4294967295),s=Number(n>>i&o),a=Number(n&o),c=r?4:0,u=r?0:4;t.setUint32(e+c,s,r),t.setUint32(e+u,a,r)}(n,r-8,BigInt(8*this.length),i),this.process(n,0);const s=Bt(t),a=this.outputLen;if(a%4)throw new Error("_sha2: outputLen should be aligned to 32bit");const c=a/4,u=this.get();if(c>u.length)throw new Error("_sha2: outputLen bigger than state");for(let t=0;t<c;t++)s.setUint32(4*t,u[t],i)}digest(){const{buffer:t,outputLen:e}=this;this.digestInto(t);const n=t.slice(0,e);return this.destroy(),n}_cloneInto(t){t||(t=new this.constructor),t.set(...this.get());const{blockLen:e,buffer:n,length:r,finished:i,destroyed:o,pos:s}=this;return t.length=r,t.pos=s,t.finished=i,t.destroyed=o,r%e&&t.buffer.set(n),t}}const Ot=(t,e,n)=>t&e^t&n^e&n,Ht=new Uint32Array([1116352408,1899447441,3049323471,3921009573,961987163,1508970993,2453635748,2870763221,3624381080,310598401,607225278,1426881987,1925078388,2162078206,2614888103,3248222580,3835390401,4022224774,264347078,604807628,770255983,1249150122,1555081692,1996064986,2554220882,2821834349,2952996808,3210313671,3336571891,3584528711,113926993,338241895,666307205,773529912,1294757372,1396182291,1695183700,1986661051,2177026350,2456956037,2730485921,2820302411,3259730800,3345764771,3516065817,3600352804,4094571909,275423344,430227734,506948616,659060556,883997877,958139571,1322822218,1537002063,1747873779,1955562222,2024104815,2227730452,2361852424,2428436474,2756734187,3204031479,3329325298]),_t=new Uint32Array([1779033703,3144134277,1013904242,2773480762,1359893119,2600822924,528734635,1541459225]),Lt=new Uint32Array(64);class jt extends $t{constructor(){super(64,32,8,!1),this.A=0|_t[0],this.B=0|_t[1],this.C=0|_t[2],this.D=0|_t[3],this.E=0|_t[4],this.F=0|_t[5],this.G=0|_t[6],this.H=0|_t[7]}get(){const{A:t,B:e,C:n,D:r,E:i,F:o,G:s,H:a}=this;return[t,e,n,r,i,o,s,a]}set(t,e,n,r,i,o,s,a){this.A=0|t,this.B=0|e,this.C=0|n,this.D=0|r,this.E=0|i,this.F=0|o,this.G=0|s,this.H=0|a}process(t,e){for(let n=0;n<16;n++,e+=4)Lt[n]=t.getUint32(e,!1);for(let t=16;t<64;t++){const e=Lt[t-15],n=Lt[t-2],r=Tt(e,7)^Tt(e,18)^e>>>3,i=Tt(n,17)^Tt(n,19)^n>>>10;Lt[t]=i+Lt[t-7]+r+Lt[t-16]|0}let{A:n,B:r,C:i,D:o,E:s,F:a,G:c,H:u}=this;for(let t=0;t<64;t++){const e=u+(Tt(s,6)^Tt(s,11)^Tt(s,25))+((f=s)&a^~f&c)+Ht[t]+Lt[t]|0,h=(Tt(n,2)^Tt(n,13)^Tt(n,22))+Ot(n,r,i)|0;u=c,c=a,a=s,s=o+e|0,o=i,i=r,r=n,n=e+h|0}var f;n=n+this.A|0,r=r+this.B|0,i=i+this.C|0,o=o+this.D|0,s=s+this.E|0,a=a+this.F|0,c=c+this.G|0,u=u+this.H|0,this.set(n,r,i,o,s,a,c,u)}roundClean(){Lt.fill(0)}destroy(){this.set(0,0,0,0,0,0,0,0),this.buffer.fill(0)}}class Mt extends jt{constructor(){super(),this.A=-1056596264,this.B=914150663,this.C=812702999,this.D=-150054599,this.E=-4191439,this.F=1750603025,this.G=1694076839,this.H=-1090891868,this.outputLen=28}}const Ft=kt((()=>new jt));kt((()=>new Mt));var Rt=i(314),Dt=i.t(Rt,2);const Kt=BigInt(0),Vt=BigInt(1),zt=BigInt(2),qt=BigInt(3),Wt=BigInt(8),Gt=Object.freeze({a:Kt,b:BigInt(7),P:BigInt("0xfffffffffffffffffffffffffffffffffffffffffffffffffffffffefffffc2f"),n:BigInt("0xfffffffffffffffffffffffffffffffebaaedce6af48a03bbfd25e8cd0364141"),h:Vt,Gx:BigInt("55066263022277343669578718895168534326250603453777594175500187360389116729240"),Gy:BigInt("32670510020758816978083085130507043184471273380659243275938904335757337482424"),beta:BigInt("0x7ae96a2b657c07106e64479eac3434e99cf0497512f58995c1396c28719501ee")}),Zt=(t,e)=>(t+e/zt)/e,Xt={beta:BigInt("0x7ae96a2b657c07106e64479eac3434e99cf0497512f58995c1396c28719501ee"),splitScalar(t){const{n:e}=Gt,n=BigInt("0x3086d221a7d46bcde86c90e49284eb15"),r=-Vt*BigInt("0xe4437ed6010e88286f547fa90abfe4c3"),i=BigInt("0x114ca50f7a8e2f3f657c1108d9d44cfd8"),o=n,s=BigInt("0x100000000000000000000000000000000"),a=Zt(o*t,e),c=Zt(-r*t,e);let u=Ee(t-a*n-c*i,e),f=Ee(-a*r-c*o,e);const h=u>s,l=f>s;if(h&&(u=e-u),l&&(f=e-f),u>s||f>s)throw new Error("splitScalarEndo: Endomorphism failed, k="+t);return{k1neg:h,k1:u,k2neg:l,k2:f}}},Jt=32,Qt=32,Yt=Jt+1,te=2*Jt+1;function ee(t){const{a:e,b:n}=Gt,r=Ee(t*t),i=Ee(r*t);return Ee(i+e*t+n)}const ne=Gt.a===Kt;class re extends Error{constructor(t){super(t)}}function ie(t){if(!(t instanceof oe))throw new TypeError("JacobianPoint expected")}class oe{constructor(t,e,n){this.x=t,this.y=e,this.z=n}static fromAffine(t){if(!(t instanceof ce))throw new TypeError("JacobianPoint#fromAffine: expected Point");return t.equals(ce.ZERO)?oe.ZERO:new oe(t.x,t.y,Vt)}static toAffineBatch(t){const e=function(t,e=Gt.P){const n=new Array(t.length),r=Be(t.reduce(((t,r,i)=>r===Kt?t:(n[i]=t,Ee(t*r,e))),Vt),e);return t.reduceRight(((t,r,i)=>r===Kt?t:(n[i]=Ee(t*n[i],e),Ee(t*r,e))),r),n}(t.map((t=>t.z)));return t.map(((t,n)=>t.toAffine(e[n])))}static normalizeZ(t){return oe.toAffineBatch(t).map(oe.fromAffine)}equals(t){ie(t);const{x:e,y:n,z:r}=this,{x:i,y:o,z:s}=t,a=Ee(r*r),c=Ee(s*s),u=Ee(e*c),f=Ee(i*a),h=Ee(Ee(n*s)*c),l=Ee(Ee(o*r)*a);return u===f&&h===l}negate(){return new oe(this.x,Ee(-this.y),this.z)}double(){const{x:t,y:e,z:n}=this,r=Ee(t*t),i=Ee(e*e),o=Ee(i*i),s=t+i,a=Ee(zt*(Ee(s*s)-r-o)),c=Ee(qt*r),u=Ee(c*c),f=Ee(u-zt*a),h=Ee(c*(a-f)-Wt*o),l=Ee(zt*e*n);return new oe(f,h,l)}add(t){ie(t);const{x:e,y:n,z:r}=this,{x:i,y:o,z:s}=t;if(i===Kt||o===Kt)return this;if(e===Kt||n===Kt)return t;const a=Ee(r*r),c=Ee(s*s),u=Ee(e*c),f=Ee(i*a),h=Ee(Ee(n*s)*c),l=Ee(Ee(o*r)*a),d=Ee(f-u),p=Ee(l-h);if(d===Kt)return p===Kt?this.double():oe.ZERO;const y=Ee(d*d),g=Ee(d*y),b=Ee(u*y),w=Ee(p*p-g-zt*b),m=Ee(p*(b-w)-h*g),v=Ee(r*s*d);return new oe(w,m,v)}subtract(t){return this.add(t.negate())}multiplyUnsafe(t){const e=oe.ZERO;if("bigint"==typeof t&&t===Kt)return e;let n=Se(t);if(n===Vt)return this;if(!ne){let t=e,r=this;for(;n>Kt;)n&Vt&&(t=t.add(r)),r=r.double(),n>>=Vt;return t}let{k1neg:r,k1:i,k2neg:o,k2:s}=Xt.splitScalar(n),a=e,c=e,u=this;for(;i>Kt||s>Kt;)i&Vt&&(a=a.add(u)),s&Vt&&(c=c.add(u)),u=u.double(),i>>=Vt,s>>=Vt;return r&&(a=a.negate()),o&&(c=c.negate()),c=new oe(Ee(c.x*Xt.beta),c.y,c.z),a.add(c)}precomputeWindow(t){const e=ne?128/t+1:256/t+1,n=[];let r=this,i=r;for(let o=0;o<e;o++){i=r,n.push(i);for(let e=1;e<2**(t-1);e++)i=i.add(r),n.push(i);r=i.double()}return n}wNAF(t,e){!e&&this.equals(oe.BASE)&&(e=ce.BASE);const n=e&&e._WINDOW_SIZE||1;if(256%n)throw new Error("Point#wNAF: Invalid precomputation window, must be power of 2");let r=e&&ae.get(e);r||(r=this.precomputeWindow(n),e&&1!==n&&(r=oe.normalizeZ(r),ae.set(e,r)));let i=oe.ZERO,o=oe.BASE;const s=1+(ne?128/n:256/n),a=2**(n-1),c=BigInt(2**n-1),u=2**n,f=BigInt(n);for(let e=0;e<s;e++){const n=e*a;let s=Number(t&c);t>>=f,s>a&&(s-=u,t+=Vt);const h=n,l=n+Math.abs(s)-1,d=e%2!=0,p=s<0;0===s?o=o.add(se(d,r[h])):i=i.add(se(p,r[l]))}return{p:i,f:o}}multiply(t,e){let n,r,i=Se(t);if(ne){const{k1neg:t,k1:o,k2neg:s,k2:a}=Xt.splitScalar(i);let{p:c,f:u}=this.wNAF(o,e),{p:f,f:h}=this.wNAF(a,e);c=se(t,c),f=se(s,f),f=new oe(Ee(f.x*Xt.beta),f.y,f.z),n=c.add(f),r=u.add(h)}else{const{p:t,f:o}=this.wNAF(i,e);n=t,r=o}return oe.normalizeZ([n,r])[0]}toAffine(t){const{x:e,y:n,z:r}=this,i=this.equals(oe.ZERO);null==t&&(t=i?Wt:Be(r));const o=t,s=Ee(o*o),a=Ee(s*o),c=Ee(e*s),u=Ee(n*a),f=Ee(r*o);if(i)return ce.ZERO;if(f!==Vt)throw new Error("invZ was invalid");return new ce(c,u)}}function se(t,e){const n=e.negate();return t?n:e}oe.BASE=new oe(Gt.Gx,Gt.Gy,Vt),oe.ZERO=new oe(Kt,Vt,Kt);const ae=new WeakMap;class ce{constructor(t,e){this.x=t,this.y=e}_setWindowSize(t){this._WINDOW_SIZE=t,ae.delete(this)}hasEvenY(){return this.y%zt===Kt}static fromCompressedHex(t){const e=32===t.length,n=Ae(e?t:t.subarray(1));if(!Ne(n))throw new Error("Point is not on curve");let r=function(t){const{P:e}=Gt,n=BigInt(6),r=BigInt(11),i=BigInt(22),o=BigInt(23),s=BigInt(44),a=BigInt(88),c=t*t*t%e,u=c*c*t%e,f=Ce(u,qt)*u%e,h=Ce(f,qt)*u%e,l=Ce(h,zt)*c%e,d=Ce(l,r)*l%e,p=Ce(d,i)*d%e,y=Ce(p,s)*p%e,g=Ce(y,a)*y%e,b=Ce(g,s)*p%e,w=Ce(b,qt)*u%e,m=Ce(w,o)*d%e,v=Ce(m,n)*c%e,A=Ce(v,zt);if(A*A%e!==t)throw new Error("Cannot find square root");return A}(ee(n));const i=(r&Vt)===Vt;e?i&&(r=Ee(-r)):1==(1&t[0])!==i&&(r=Ee(-r));const o=new ce(n,r);return o.assertValidity(),o}static fromUncompressedHex(t){const e=Ae(t.subarray(1,Jt+1)),n=Ae(t.subarray(Jt+1,2*Jt+1)),r=new ce(e,n);return r.assertValidity(),r}static fromHex(t){const e=xe(t),n=e.length,r=e[0];if(n===Jt)return this.fromCompressedHex(e);if(n===Yt&&(2===r||3===r))return this.fromCompressedHex(e);if(n===te&&4===r)return this.fromUncompressedHex(e);throw new Error(`Point.fromHex: received invalid point. Expected 32-${Yt} compressed bytes or ${te} uncompressed bytes, not ${n}`)}static fromPrivateKey(t){return ce.BASE.multiply(Oe(t))}static fromSignature(t,e,n){const{r,s:i}=function(t){if(t instanceof he)return t.assertValidity(),t;try{return he.fromDER(t)}catch(e){return he.fromCompact(t)}}(e);if(![0,1,2,3].includes(n))throw new Error("Cannot recover: invalid recovery bit");const o=Te(xe(t)),{n:s}=Gt,a=2===n||3===n?r+s:r,c=Be(a,s),u=Ee(-o*c,s),f=Ee(i*c,s),h=1&n?"03":"02",l=ce.fromHex(h+ge(a)),d=ce.BASE.multiplyAndAddUnsafe(l,u,f);if(!d)throw new Error("Cannot recover signature: point at infinify");return d.assertValidity(),d}toRawBytes(t=!1){return ve(this.toHex(t))}toHex(t=!1){const e=ge(this.x);return t?`${this.hasEvenY()?"02":"03"}${e}`:`04${e}${ge(this.y)}`}toHexX(){return this.toHex(!0).slice(2)}toRawX(){return this.toRawBytes(!0).slice(1)}assertValidity(){const t="Point is not on elliptic curve",{x:e,y:n}=this;if(!Ne(e)||!Ne(n))throw new Error(t);const r=Ee(n*n);if(Ee(r-ee(e))!==Kt)throw new Error(t)}equals(t){return this.x===t.x&&this.y===t.y}negate(){return new ce(this.x,Ee(-this.y))}double(){return oe.fromAffine(this).double().toAffine()}add(t){return oe.fromAffine(this).add(oe.fromAffine(t)).toAffine()}subtract(t){return this.add(t.negate())}multiply(t){return oe.fromAffine(this).multiply(t,this).toAffine()}multiplyAndAddUnsafe(t,e,n){const r=oe.fromAffine(this),i=e===Kt||e===Vt||this!==ce.BASE?r.multiplyUnsafe(e):r.multiply(e),o=oe.fromAffine(t).multiplyUnsafe(n),s=i.add(o);return s.equals(oe.ZERO)?void 0:s.toAffine()}}function ue(t){return Number.parseInt(t[0],16)>=8?"00"+t:t}function fe(t){if(t.length<2||2!==t[0])throw new Error(`Invalid signature integer tag: ${pe(t)}`);const e=t[1],n=t.subarray(2,e+2);if(!e||n.length!==e)throw new Error("Invalid signature integer: wrong length");if(0===n[0]&&n[1]<=127)throw new Error("Invalid signature integer: trailing length");return{data:Ae(n),left:t.subarray(e+2)}}ce.BASE=new ce(Gt.Gx,Gt.Gy),ce.ZERO=new ce(Kt,Kt);class he{constructor(t,e){this.r=t,this.s=e,this.assertValidity()}static fromCompact(t){const e=t instanceof Uint8Array,n="Signature.fromCompact";if("string"!=typeof t&&!e)throw new TypeError(`${n}: Expected string or Uint8Array`);const r=e?pe(t):t;if(128!==r.length)throw new Error(`${n}: Expected 64-byte hex`);return new he(me(r.slice(0,64)),me(r.slice(64,128)))}static fromDER(t){const e=t instanceof Uint8Array;if("string"!=typeof t&&!e)throw new TypeError("Signature.fromDER: Expected string or Uint8Array");const{r:n,s:r}=function(t){if(t.length<2||48!=t[0])throw new Error(`Invalid signature tag: ${pe(t)}`);if(t[1]!==t.length-2)throw new Error("Invalid signature: incorrect length");const{data:e,left:n}=fe(t.subarray(2)),{data:r,left:i}=fe(n);if(i.length)throw new Error(`Invalid signature: left bytes after parsing: ${pe(i)}`);return{r:e,s:r}}(e?t:ve(t));return new he(n,r)}static fromHex(t){return this.fromDER(t)}assertValidity(){const{r:t,s:e}=this;if(!Pe(t))throw new Error("Invalid Signature: r must be 0 < r < n");if(!Pe(e))throw new Error("Invalid Signature: s must be 0 < s < n")}hasHighS(){const t=Gt.n>>Vt;return this.s>t}normalizeS(){return this.hasHighS()?new he(this.r,Ee(-this.s,Gt.n)):this}toDERRawBytes(){return ve(this.toDERHex())}toDERHex(){const t=ue(we(this.s)),e=ue(we(this.r)),n=t.length/2,r=e.length/2,i=we(n),o=we(r);return`30${we(r+n+4)}02${o}${e}02${i}${t}`}toRawBytes(){return this.toDERRawBytes()}toHex(){return this.toDERHex()}toCompactRawBytes(){return ve(this.toCompactHex())}toCompactHex(){return ge(this.r)+ge(this.s)}}function le(...t){if(!t.every((t=>t instanceof Uint8Array)))throw new Error("Uint8Array list expected");if(1===t.length)return t[0];const e=t.reduce(((t,e)=>t+e.length),0),n=new Uint8Array(e);for(let e=0,r=0;e<t.length;e++){const i=t[e];n.set(i,r),r+=i.length}return n}const de=Array.from({length:256},((t,e)=>e.toString(16).padStart(2,"0")));function pe(t){if(!(t instanceof Uint8Array))throw new Error("Expected Uint8Array");let e="";for(let n=0;n<t.length;n++)e+=de[t[n]];return e}const ye=BigInt("0x10000000000000000000000000000000000000000000000000000000000000000");function ge(t){if("bigint"!=typeof t)throw new Error("Expected bigint");if(!(Kt<=t&&t<ye))throw new Error("Expected number 0 <= n < 2^256");return t.toString(16).padStart(64,"0")}function be(t){const e=ve(ge(t));if(32!==e.length)throw new Error("Error: expected 32 bytes");return e}function we(t){const e=t.toString(16);return 1&e.length?`0${e}`:e}function me(t){if("string"!=typeof t)throw new TypeError("hexToNumber: expected string, got "+typeof t);return BigInt(`0x${t}`)}function ve(t){if("string"!=typeof t)throw new TypeError("hexToBytes: expected string, got "+typeof t);if(t.length%2)throw new Error("hexToBytes: received invalid unpadded hex"+t.length);const e=new Uint8Array(t.length/2);for(let n=0;n<e.length;n++){const r=2*n,i=t.slice(r,r+2),o=Number.parseInt(i,16);if(Number.isNaN(o)||o<0)throw new Error("Invalid byte sequence");e[n]=o}return e}function Ae(t){return me(pe(t))}function xe(t){return t instanceof Uint8Array?Uint8Array.from(t):ve(t)}function Se(t){if("number"==typeof t&&Number.isSafeInteger(t)&&t>0)return BigInt(t);if("bigint"==typeof t&&Pe(t))return t;throw new TypeError("Expected valid private scalar: 0 < scalar < curve.n")}function Ee(t,e=Gt.P){const n=t%e;return n>=Kt?n:e+n}function Ce(t,e){const{P:n}=Gt;let r=t;for(;e-- >Kt;)r*=r,r%=n;return r}function Be(t,e=Gt.P){if(t===Kt||e<=Kt)throw new Error(`invert: expected positive integers, got n=${t} mod=${e}`);let n=Ee(t,e),r=e,i=Kt,o=Vt,s=Vt,a=Kt;for(;n!==Kt;){const t=r/n,e=r%n,c=i-s*t,u=o-a*t;r=n,n=e,i=s,o=a,s=c,a=u}if(r!==Vt)throw new Error("invert: does not exist");return Ee(i,e)}function Te(t,e=!1){const n=function(t){const e=8*t.length-8*Qt,n=Ae(t);return e>0?n>>BigInt(e):n}(t);if(e)return n;const{n:r}=Gt;return n>=r?n-r:n}let Ie,Ue;class ke{constructor(t,e){if(this.hashLen=t,this.qByteLen=e,"number"!=typeof t||t<2)throw new Error("hashLen must be a number");if("number"!=typeof e||e<2)throw new Error("qByteLen must be a number");this.v=new Uint8Array(t).fill(1),this.k=new Uint8Array(t).fill(0),this.counter=0}hmac(...t){return Fe.hmacSha256(this.k,...t)}hmacSync(...t){return Ue(this.k,...t)}checkSync(){if("function"!=typeof Ue)throw new re("hmacSha256Sync needs to be set")}incr(){if(this.counter>=1e3)throw new Error("Tried 1,000 k values for sign(), all were invalid");this.counter+=1}async reseed(t=new Uint8Array){this.k=await this.hmac(this.v,Uint8Array.from([0]),t),this.v=await this.hmac(this.v),0!==t.length&&(this.k=await this.hmac(this.v,Uint8Array.from([1]),t),this.v=await this.hmac(this.v))}reseedSync(t=new Uint8Array){this.checkSync(),this.k=this.hmacSync(this.v,Uint8Array.from([0]),t),this.v=this.hmacSync(this.v),0!==t.length&&(this.k=this.hmacSync(this.v,Uint8Array.from([1]),t),this.v=this.hmacSync(this.v))}async generate(){this.incr();let t=0;const e=[];for(;t<this.qByteLen;){this.v=await this.hmac(this.v);const n=this.v.slice();e.push(n),t+=this.v.length}return le(...e)}generateSync(){this.checkSync(),this.incr();let t=0;const e=[];for(;t<this.qByteLen;){this.v=this.hmacSync(this.v);const n=this.v.slice();e.push(n),t+=this.v.length}return le(...e)}}function Pe(t){return Kt<t&&t<Gt.n}function Ne(t){return Kt<t&&t<Gt.P}function $e(t,e,n,r=!0){const{n:i}=Gt,o=Te(t,!0);if(!Pe(o))return;const s=Be(o,i),a=ce.BASE.multiply(o),c=Ee(a.x,i);if(c===Kt)return;const u=Ee(s*Ee(e+n*c,i),i);if(u===Kt)return;let f=new he(c,u),h=(a.x===f.r?0:2)|Number(a.y&Vt);return r&&f.hasHighS()&&(f=f.normalizeS(),h^=1),{sig:f,recovery:h}}function Oe(t){let e;if("bigint"==typeof t)e=t;else if("number"==typeof t&&Number.isSafeInteger(t)&&t>0)e=BigInt(t);else if("string"==typeof t){if(t.length!==2*Qt)throw new Error("Expected 32 bytes of private key");e=me(t)}else{if(!(t instanceof Uint8Array))throw new TypeError("Expected valid private key");if(t.length!==Qt)throw new Error("Expected 32 bytes of private key");e=Ae(t)}if(!Pe(e))throw new Error("Expected private key: 0 < key < n");return e}function He(t){return Ae(t.length>Jt?t.slice(0,Jt):t)}function _e(t){const e=He(t),n=Ee(e,Gt.n);return Le(n<Kt?e:n)}function Le(t){return be(t)}ce.BASE._setWindowSize(8);const je={node:Dt,web:"object"==typeof self&&"crypto"in self?self.crypto:void 0},Me={},Fe={bytesToHex:pe,hexToBytes:ve,concatBytes:le,mod:Ee,invert:Be,isValidPrivateKey(t){try{return Oe(t),!0}catch(t){return!1}},_bigintTo32Bytes:be,_normalizePrivateKey:Oe,hashToPrivateKey:t=>{t=xe(t);const e=Qt+8;if(t.length<e||t.length>1024)throw new Error("Expected valid bytes of private key as per FIPS 186");return be(Ee(Ae(t),Gt.n-Vt)+Vt)},randomBytes:(t=32)=>{if(je.web)return je.web.getRandomValues(new Uint8Array(t));if(je.node){const{randomBytes:e}=je.node;return Uint8Array.from(e(t))}throw new Error("The environment doesn't have randomBytes function")},randomPrivateKey:()=>Fe.hashToPrivateKey(Fe.randomBytes(Qt+8)),precompute(t=8,e=ce.BASE){const n=e===ce.BASE?e:new ce(e.x,e.y);return n._setWindowSize(t),n.multiply(qt),n},sha256:async(...t)=>{if(je.web){const e=await je.web.subtle.digest("SHA-256",le(...t));return new Uint8Array(e)}if(je.node){const{createHash:e}=je.node,n=e("sha256");return t.forEach((t=>n.update(t))),Uint8Array.from(n.digest())}throw new Error("The environment doesn't have sha256 function")},hmacSha256:async(t,...e)=>{if(je.web){const n=await je.web.subtle.importKey("raw",t,{name:"HMAC",hash:{name:"SHA-256"}},!1,["sign"]),r=le(...e),i=await je.web.subtle.sign("HMAC",n,r);return new Uint8Array(i)}if(je.node){const{createHmac:n}=je.node,r=n("sha256",t);return e.forEach((t=>r.update(t))),Uint8Array.from(r.digest())}throw new Error("The environment doesn't have hmac-sha256 function")},sha256Sync:void 0,hmacSha256Sync:void 0,taggedHash:async(t,...e)=>{let n=Me[t];if(void 0===n){const e=await Fe.sha256(Uint8Array.from(t,(t=>t.charCodeAt(0))));n=le(e,e),Me[t]=n}return Fe.sha256(n,...e)},taggedHashSync:(t,...e)=>{if("function"!=typeof Ie)throw new re("sha256Sync is undefined, you need to set it");let n=Me[t];if(void 0===n){const e=Ie(Uint8Array.from(t,(t=>t.charCodeAt(0))));n=le(e,e),Me[t]=n}return Ie(n,...e)},_JacobianPoint:oe};Object.defineProperties(Fe,{sha256Sync:{configurable:!1,get:()=>Ie,set(t){Ie||(Ie=t)}},hmacSha256Sync:{configurable:!1,get:()=>Ue,set(t){Ue||(Ue=t)}}});const Re=32;function De(t){const e="string"==typeof t?h(t):t;if(32!=e.length&&33!=e.length)throw new Error(`Improperly formatted private-key. Private-key byte length should be 32 or 33. Length provided: ${e.length}`);if(33==e.length&&1!==e[32])throw new Error("Improperly formatted private-key. 33 bytes indicate compressed key, but the last byte must be == 01");return e}const Ke=new Uint8Array([7,4,13,1,10,6,15,3,12,0,9,5,2,14,11,8]),Ve=Uint8Array.from({length:16},((t,e)=>e)),ze=Ve.map((t=>(9*t+5)%16));let qe=[Ve],We=[ze];for(let t=0;t<4;t++)for(let e of[qe,We])e.push(e[t].map((t=>Ke[t])));const Ge=[[11,14,15,12,5,8,7,9,11,13,14,15,6,7,9,8],[12,13,11,15,6,9,9,7,12,15,11,13,7,8,7,7],[13,15,14,11,7,7,6,8,13,14,13,12,5,5,6,9],[14,11,12,14,8,6,5,5,15,12,15,14,9,9,8,6],[15,12,13,13,9,5,8,6,14,11,12,11,8,6,5,5]].map((t=>new Uint8Array(t))),Ze=qe.map(((t,e)=>t.map((t=>Ge[e][t])))),Xe=We.map(((t,e)=>t.map((t=>Ge[e][t])))),Je=new Uint32Array([0,1518500249,1859775393,2400959708,2840853838]),Qe=new Uint32Array([1352829926,1548603684,1836072691,2053994217,0]),Ye=(t,e)=>t<<e|t>>>32-e;function tn(t,e,n,r){return 0===t?e^n^r:1===t?e&n|~e&r:2===t?(e|~n)^r:3===t?e&r|n&~r:e^(n|~r)}const en=new Uint32Array(16);class nn extends $t{constructor(){super(64,20,8,!0),this.h0=1732584193,this.h1=-271733879,this.h2=-1732584194,this.h3=271733878,this.h4=-1009589776}get(){const{h0:t,h1:e,h2:n,h3:r,h4:i}=this;return[t,e,n,r,i]}set(t,e,n,r,i){this.h0=0|t,this.h1=0|e,this.h2=0|n,this.h3=0|r,this.h4=0|i}process(t,e){for(let n=0;n<16;n++,e+=4)en[n]=t.getUint32(e,!0);let n=0|this.h0,r=n,i=0|this.h1,o=i,s=0|this.h2,a=s,c=0|this.h3,u=c,f=0|this.h4,h=f;for(let t=0;t<5;t++){const e=4-t,l=Je[t],d=Qe[t],p=qe[t],y=We[t],g=Ze[t],b=Xe[t];for(let e=0;e<16;e++){const r=Ye(n+tn(t,i,s,c)+en[p[e]]+l,g[e])+f|0;n=f,f=c,c=0|Ye(s,10),s=i,i=r}for(let t=0;t<16;t++){const n=Ye(r+tn(e,o,a,u)+en[y[t]]+d,b[t])+h|0;r=h,h=u,u=0|Ye(a,10),a=o,o=n}}this.set(this.h1+s+u|0,this.h2+c+h|0,this.h3+f+r|0,this.h4+n+o|0,this.h0+i+a|0)}roundClean(){en.fill(0)}destroy(){this.destroyed=!0,this.buffer.fill(0),this.set(0,0,0,0,0)}}const rn=kt((()=>new nn)),on=BigInt(2**32-1),sn=BigInt(32);function an(t,e=!1){return e?{h:Number(t&on),l:Number(t>>sn&on)}:{h:0|Number(t>>sn&on),l:0|Number(t&on)}}const cn=function(t,e=!1){let n=new Uint32Array(t.length),r=new Uint32Array(t.length);for(let i=0;i<t.length;i++){const{h:o,l:s}=an(t[i],e);[n[i],r[i]]=[o,s]}return[n,r]},un=(t,e,n)=>t>>>n,fn=(t,e,n)=>t<<32-n|e>>>n,hn=(t,e,n)=>t>>>n|e<<32-n,ln=(t,e,n)=>t<<32-n|e>>>n,dn=(t,e,n)=>t<<64-n|e>>>n-32,pn=(t,e,n)=>t>>>n-32|e<<64-n,yn=function(t,e,n,r){const i=(e>>>0)+(r>>>0);return{h:t+n+(i/2**32|0)|0,l:0|i}},gn=(t,e,n)=>(t>>>0)+(e>>>0)+(n>>>0),bn=(t,e,n,r)=>e+n+r+(t/2**32|0)|0,wn=(t,e,n,r)=>(t>>>0)+(e>>>0)+(n>>>0)+(r>>>0),mn=(t,e,n,r,i)=>e+n+r+i+(t/2**32|0)|0,vn=(t,e,n,r,i,o)=>e+n+r+i+o+(t/2**32|0)|0,An=(t,e,n,r,i)=>(t>>>0)+(e>>>0)+(n>>>0)+(r>>>0)+(i>>>0),[xn,Sn]=cn(["0x428a2f98d728ae22","0x7137449123ef65cd","0xb5c0fbcfec4d3b2f","0xe9b5dba58189dbbc","0x3956c25bf348b538","0x59f111f1b605d019","0x923f82a4af194f9b","0xab1c5ed5da6d8118","0xd807aa98a3030242","0x12835b0145706fbe","0x243185be4ee4b28c","0x550c7dc3d5ffb4e2","0x72be5d74f27b896f","0x80deb1fe3b1696b1","0x9bdc06a725c71235","0xc19bf174cf692694","0xe49b69c19ef14ad2","0xefbe4786384f25e3","0x0fc19dc68b8cd5b5","0x240ca1cc77ac9c65","0x2de92c6f592b0275","0x4a7484aa6ea6e483","0x5cb0a9dcbd41fbd4","0x76f988da831153b5","0x983e5152ee66dfab","0xa831c66d2db43210","0xb00327c898fb213f","0xbf597fc7beef0ee4","0xc6e00bf33da88fc2","0xd5a79147930aa725","0x06ca6351e003826f","0x142929670a0e6e70","0x27b70a8546d22ffc","0x2e1b21385c26c926","0x4d2c6dfc5ac42aed","0x53380d139d95b3df","0x650a73548baf63de","0x766a0abb3c77b2a8","0x81c2c92e47edaee6","0x92722c851482353b","0xa2bfe8a14cf10364","0xa81a664bbc423001","0xc24b8b70d0f89791","0xc76c51a30654be30","0xd192e819d6ef5218","0xd69906245565a910","0xf40e35855771202a","0x106aa07032bbd1b8","0x19a4c116b8d2d0c8","0x1e376c085141ab53","0x2748774cdf8eeb99","0x34b0bcb5e19b48a8","0x391c0cb3c5c95a63","0x4ed8aa4ae3418acb","0x5b9cca4f7763e373","0x682e6ff3d6b2b8a3","0x748f82ee5defb2fc","0x78a5636f43172f60","0x84c87814a1f0ab72","0x8cc702081a6439ec","0x90befffa23631e28","0xa4506cebde82bde9","0xbef9a3f7b2c67915","0xc67178f2e372532b","0xca273eceea26619c","0xd186b8c721c0c207","0xeada7dd6cde0eb1e","0xf57d4f7fee6ed178","0x06f067aa72176fba","0x0a637dc5a2c898a6","0x113f9804bef90dae","0x1b710b35131c471b","0x28db77f523047d84","0x32caab7b40c72493","0x3c9ebe0a15c9bebc","0x431d67c49c100d4c","0x4cc5d4becb3e42b6","0x597f299cfc657e2a","0x5fcb6fab3ad6faec","0x6c44198c4a475817"].map((t=>BigInt(t)))),En=new Uint32Array(80),Cn=new Uint32Array(80);class Bn extends $t{constructor(){super(128,64,16,!1),this.Ah=1779033703,this.Al=-205731576,this.Bh=-1150833019,this.Bl=-2067093701,this.Ch=1013904242,this.Cl=-23791573,this.Dh=-1521486534,this.Dl=1595750129,this.Eh=1359893119,this.El=-1377402159,this.Fh=-1694144372,this.Fl=725511199,this.Gh=528734635,this.Gl=-79577749,this.Hh=1541459225,this.Hl=327033209}get(){const{Ah:t,Al:e,Bh:n,Bl:r,Ch:i,Cl:o,Dh:s,Dl:a,Eh:c,El:u,Fh:f,Fl:h,Gh:l,Gl:d,Hh:p,Hl:y}=this;return[t,e,n,r,i,o,s,a,c,u,f,h,l,d,p,y]}set(t,e,n,r,i,o,s,a,c,u,f,h,l,d,p,y){this.Ah=0|t,this.Al=0|e,this.Bh=0|n,this.Bl=0|r,this.Ch=0|i,this.Cl=0|o,this.Dh=0|s,this.Dl=0|a,this.Eh=0|c,this.El=0|u,this.Fh=0|f,this.Fl=0|h,this.Gh=0|l,this.Gl=0|d,this.Hh=0|p,this.Hl=0|y}process(t,e){for(let n=0;n<16;n++,e+=4)En[n]=t.getUint32(e),Cn[n]=t.getUint32(e+=4);for(let t=16;t<80;t++){const e=0|En[t-15],n=0|Cn[t-15],r=hn(e,n,1)^hn(e,n,8)^un(e,n,7),i=ln(e,n,1)^ln(e,n,8)^fn(e,n,7),o=0|En[t-2],s=0|Cn[t-2],a=hn(o,s,19)^dn(o,s,61)^un(o,s,6),c=ln(o,s,19)^pn(o,s,61)^fn(o,s,6),u=wn(i,c,Cn[t-7],Cn[t-16]),f=mn(u,r,a,En[t-7],En[t-16]);En[t]=0|f,Cn[t]=0|u}let{Ah:n,Al:r,Bh:i,Bl:o,Ch:s,Cl:a,Dh:c,Dl:u,Eh:f,El:h,Fh:l,Fl:d,Gh:p,Gl:y,Hh:g,Hl:b}=this;for(let t=0;t<80;t++){const e=hn(f,h,14)^hn(f,h,18)^dn(f,h,41),w=ln(f,h,14)^ln(f,h,18)^pn(f,h,41),m=f&l^~f&p,v=An(b,w,h&d^~h&y,Sn[t],Cn[t]),A=vn(v,g,e,m,xn[t],En[t]),x=0|v,S=hn(n,r,28)^dn(n,r,34)^dn(n,r,39),E=ln(n,r,28)^pn(n,r,34)^pn(n,r,39),C=n&i^n&s^i&s,B=r&o^r&a^o&a;g=0|p,b=0|y,p=0|l,y=0|d,l=0|f,d=0|h,({h:f,l:h}=yn(0|c,0|u,0|A,0|x)),c=0|s,u=0|a,s=0|i,a=0|o,i=0|n,o=0|r;const T=gn(x,E,B);n=bn(T,A,S,C),r=0|T}({h:n,l:r}=yn(0|this.Ah,0|this.Al,0|n,0|r)),({h:i,l:o}=yn(0|this.Bh,0|this.Bl,0|i,0|o)),({h:s,l:a}=yn(0|this.Ch,0|this.Cl,0|s,0|a)),({h:c,l:u}=yn(0|this.Dh,0|this.Dl,0|c,0|u)),({h:f,l:h}=yn(0|this.Eh,0|this.El,0|f,0|h)),({h:l,l:d}=yn(0|this.Fh,0|this.Fl,0|l,0|d)),({h:p,l:y}=yn(0|this.Gh,0|this.Gl,0|p,0|y)),({h:g,l:b}=yn(0|this.Hh,0|this.Hl,0|g,0|b)),this.set(n,r,i,o,s,a,c,u,f,h,l,d,p,y,g,b)}roundClean(){En.fill(0),Cn.fill(0)}destroy(){this.buffer.fill(0),this.set(0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0)}}class Tn extends Bn{constructor(){super(),this.Ah=-1942145080,this.Al=424955298,this.Bh=1944164710,this.Bl=-1982016298,this.Ch=502970286,this.Cl=855612546,this.Dh=1738396948,this.Dl=1479516111,this.Eh=258812777,this.El=2077511080,this.Fh=2011393907,this.Fl=79989058,this.Gh=1067287976,this.Gl=1780299464,this.Hh=286451373,this.Hl=-1848208735,this.outputLen=28}}class In extends Bn{constructor(){super(),this.Ah=573645204,this.Al=-64227540,this.Bh=-1621794909,this.Bl=-934517566,this.Ch=596883563,this.Cl=1867755857,this.Dh=-1774684391,this.Dl=1497426621,this.Eh=-1775747358,this.El=-1467023389,this.Fh=-1101128155,this.Fl=1401305490,this.Gh=721525244,this.Gl=746961066,this.Hh=246885852,this.Hl=-2117784414,this.outputLen=32}}class Un extends Bn{constructor(){super(),this.Ah=-876896931,this.Al=-1056596264,this.Bh=1654270250,this.Bl=914150663,this.Ch=-1856437926,this.Cl=812702999,this.Dh=355462360,this.Dl=-150054599,this.Eh=1731405415,this.El=-4191439,this.Fh=-1900787065,this.Fl=1750603025,this.Gh=-619958771,this.Gl=1694076839,this.Hh=1203062813,this.Hl=-1090891868,this.outputLen=48}}kt((()=>new Bn)),kt((()=>new Tn));const kn=kt((()=>new In));kt((()=>new Un));var Pn=i(907),Nn=i.n(Pn);const $n=new Map;function On(t,e){const n=$n.get(t);if(void 0!==n)return n(e);const r=function(t){const e=Object.values(t).filter((t=>"number"==typeof t)),n=new Set(e);return t=>n.has(t)}(t);return $n.set(t,r),On(t,e)}class Hn{constructor(t){this.consumed=0,this.source="string"==typeof t?h(t):t}readBytes(t){const e=this.source.subarray(this.consumed,this.consumed+t);return this.consumed+=t,e}readUInt32BE(){return(t=this.readBytes(4))[0]*2**24+65536*t[1]+256*t[2]+t[3];var t}readUInt8(){return this.readBytes(1)[0]}readUInt16BE(){return((t=this.readBytes(2))[0+0]<<8|t[1])>>>0;var t}readBigUIntLE(t){const e=f(this.readBytes(t).slice().reverse());return BigInt(`0x${e}`)}readBigUIntBE(t){const e=f(this.readBytes(t));return BigInt(`0x${e}`)}get readOffset(){return this.consumed}set readOffset(t){this.consumed=t}get internalBytes(){return this.source}readUInt8Enum(t,e){const n=this.readUInt8();if(On(t,n))return n;throw e(n)}}var _n,Ln,jn,Mn,Fn;function Rn(t){return Ln[t]}function Dn(){return{type:_n.OptionalNone}}function Kn(t){return{type:_n.OptionalSome,value:t}}function Vn(t,e){return{type:jn.LengthPrefixedList,lengthPrefixBytes:e||4,values:t}}function zn(t){if(h(t).byteLength!=R)throw Error("Invalid signature");return{type:jn.MessageSignature,data:t}}function qn(t,e,n){const r=e||1,i=n||j;if(Br(t,i))throw new Error(`String length exceeds maximum bytes ${i}`);return{type:jn.LengthPrefixedString,content:t,lengthPrefixBytes:r,maxLengthBytes:i}}function Wn(t){const e=(0,_.yI)(t);return{type:jn.Address,version:e[0],hash160:e[1]}}function Gn(t,e){return{pubKeyEncoding:t,type:jn.TransactionAuthField,contents:e}}function Zn(e){switch(e.type){case jn.Address:return Xn(e);case jn.Principal:return Qn(e);case jn.LengthPrefixedString:return Yn(e);case jn.MemoString:return function(t){const e=[],n=l(t.content),r=Cr(f(n),2*D);return e.push(h(r)),m(e)}(e);case jn.Asset:return er(e);case jn.PostCondition:return function(e){const n=[];if(n.push(e.conditionType),n.push(Qn(e.principal)),e.conditionType!==X.Fungible&&e.conditionType!==X.NonFungible||n.push(er(e.asset)),e.conditionType===X.NonFungible&&n.push(cr(e.assetName)),n.push(e.conditionCode),e.conditionType===X.STX||e.conditionType===X.Fungible){if(e.amount>BigInt("0xffffffffffffffff"))throw new wt("The post-condition amount may not be larger than 8 bytes");n.push(t(e.amount,8))}return m(n)}(e);case jn.PublicKey:return or(e);case jn.LengthPrefixedList:return nr(e);case jn.Payload:return rr(e);case jn.TransactionAuthField:return function(t){const e=[];switch(t.contents.type){case jn.PublicKey:e.push(t.pubKeyEncoding===Y.Compressed?ot.PublicKeyCompressed:ot.PublicKeyUncompressed),e.push(h((n=t.contents.data,ce.fromHex(jr(n)).toHex(!0))));break;case jn.MessageSignature:e.push(t.pubKeyEncoding===Y.Compressed?ot.SignatureCompressed:ot.SignatureUncompressed),e.push(ir(t.contents))}var n;return m(e)}(e);case jn.MessageSignature:return ir(e)}}function Xn(t){const e=[];return e.push(h(r(t.version,1))),e.push(h(t.hash160)),m(e)}function Jn(t){const e=v(t,Hn)?t:new Hn(t),n=s(f(e.readBytes(1))),r=f(e.readBytes(20));return{type:jn.Address,version:n,hash160:r}}function Qn(t){const e=[];return e.push(t.prefix),t.prefix!==nt.Standard&&t.prefix!==nt.Contract||e.push(Xn(t.address)),t.prefix===nt.Contract&&e.push(Yn(t.contractName)),m(e)}function Yn(t){const e=[],n=l(t.content),i=n.byteLength;return e.push(h(r(i,t.lengthPrefixBytes))),e.push(n),m(e)}function tr(t,e,n){e=e||1;const r=v(t,Hn)?t:new Hn(t),i=s(f(r.readBytes(e)));return qn(d(r.readBytes(i)),e,n??128)}function er(t){const e=[];return e.push(Xn(t.address)),e.push(Yn(t.contractName)),e.push(Yn(t.assetName)),m(e)}function nr(t){const e=t.values,n=[];n.push(h(r(e.length,t.lengthPrefixBytes)));for(const t of e)n.push(Zn(t));return m(n)}function rr(e){const n=[];switch(n.push(e.payloadType),e.payloadType){case K.TokenTransfer:n.push(cr(e.recipient)),n.push(t(e.amount,8)),n.push(Zn(e.memo));break;case K.ContractCall:n.push(Zn(e.contractAddress)),n.push(Zn(e.contractName)),n.push(Zn(e.functionName));const r=new Uint8Array(4);L(r,e.functionArgs.length,0),n.push(r),e.functionArgs.forEach((t=>{n.push(cr(t))}));break;case K.SmartContract:n.push(Zn(e.contractName)),n.push(Zn(e.codeBody));break;case K.VersionedSmartContract:n.push(e.clarityVersion),n.push(Zn(e.contractName)),n.push(Zn(e.codeBody));break;case K.PoisonMicroblock:break;case K.Coinbase:n.push(e.coinbaseBytes);break;case K.CoinbaseToAltRecipient:n.push(e.coinbaseBytes),n.push(cr(e.recipient));break;case K.NakamotoCoinbase:n.push(e.coinbaseBytes),n.push(cr(e.recipient?Kn(e.recipient):Dn())),n.push(e.vrfProof);break;case K.TenureChange:n.push(h(e.tenureHash)),n.push(h(e.previousTenureHash)),n.push(h(e.burnViewHash)),n.push(h(e.previousTenureEnd)),n.push(L(new Uint8Array(4),e.previousTenureBlocks)),n.push(function(t,e,n=0){return t[n]=e,t}(new Uint8Array(1),e.cause)),n.push(h(e.publicKeyHash))}return m(n)}function ir(t){return h(t.data)}function or(t){return t.data.slice()}function sr(t,e){return m([Rn(t),e])}function ar(t,e){const n=[],r="ascii"==e?p(t.value):l(t.value),i=new Uint8Array(4);return L(i,r.length,0),n.push(i),n.push(r),sr(t.type,m(n))}function cr(t){switch(t.type){case _n.BoolTrue:case _n.BoolFalse:return function(t){return new Uint8Array([Rn(t.type)])}(t);case _n.OptionalNone:case _n.OptionalSome:return(e=t).type===_n.OptionalNone?new Uint8Array([Rn(e.type)]):sr(e.type,cr(e.value));case _n.Buffer:return function(t){const e=new Uint8Array(4);return L(e,Math.ceil(t.value.length/2),0),sr(t.type,w(e,h(t.value)))}(t);case _n.UInt:return function(t){const e=a(BigInt(t.value),F);return sr(t.type,e)}(t);case _n.Int:return function(t){const e=a(function(t,e){if(t<-(BigInt(1)<<e-BigInt(1))||(BigInt(1)<<e-BigInt(1))-BigInt(1)<t)throw`Unable to represent integer in width: ${e}`;return t>=BigInt(0)?BigInt(t):t+(BigInt(1)<<e)}(BigInt(t.value),BigInt(M)),F);return sr(t.type,e)}(t);case _n.PrincipalStandard:return function(t){return sr(t.type,Xn(Wn(t.value)))}(t);case _n.PrincipalContract:return function(t){const[e,n]=function(t){const[e,n]=t.split(".");if(!e||!n)throw new Error(`Invalid contract identifier: ${t}`);return[e,n]}(t.value);return sr(t.type,w(Xn(Wn(e)),Yn(qn(n))))}(t);case _n.ResponseOk:case _n.ResponseErr:return function(t){return sr(t.type,cr(t.value))}(t);case _n.List:return function(t){const e=[],n=new Uint8Array(4);L(n,t.value.length,0),e.push(n);for(const n of t.value){const t=cr(n);e.push(t)}return sr(t.type,m(e))}(t);case _n.Tuple:return function(t){const e=[],n=new Uint8Array(4);L(n,Object.keys(t.value).length,0),e.push(n);const r=Object.keys(t.value).sort(((t,e)=>t.localeCompare(e)));for(const n of r){const r=qn(n);e.push(Yn(r));const i=cr(t.value[n]);e.push(i)}return sr(t.type,m(e))}(t);case _n.StringASCII:return function(t){return ar(t,"ascii")}(t);case _n.StringUTF8:return function(t){return ar(t,"utf8")}(t);default:throw new wt("Unable to serialize. Invalid Clarity Value.")}var e}(Fn=_n||(_n={})).Int="int",Fn.UInt="uint",Fn.Buffer="buffer",Fn.BoolTrue="true",Fn.BoolFalse="false",Fn.PrincipalStandard="address",Fn.PrincipalContract="contract",Fn.ResponseOk="ok",Fn.ResponseErr="err",Fn.OptionalNone="none",Fn.OptionalSome="some",Fn.List="list",Fn.Tuple="tuple",Fn.StringASCII="ascii",Fn.StringUTF8="utf8",function(t){t[t.int=0]="int",t[t.uint=1]="uint",t[t.buffer=2]="buffer",t[t.true=3]="true",t[t.false=4]="false",t[t.address=5]="address",t[t.contract=6]="contract",t[t.ok=7]="ok",t[t.err=8]="err",t[t.none=9]="none",t[t.some=10]="some",t[t.list=11]="list",t[t.tuple=12]="tuple",t[t.ascii=13]="ascii",t[t.utf8=14]="utf8"}(Ln||(Ln={})),(Mn=jn||(jn={}))[Mn.Address=0]="Address",Mn[Mn.Principal=1]="Principal",Mn[Mn.LengthPrefixedString=2]="LengthPrefixedString",Mn[Mn.MemoString=3]="MemoString",Mn[Mn.Asset=4]="Asset",Mn[Mn.PostCondition=5]="PostCondition",Mn[Mn.PublicKey=6]="PublicKey",Mn[Mn.LengthPrefixedList=7]="LengthPrefixedList",Mn[Mn.Payload=8]="Payload",Mn[Mn.MessageSignature=9]="MessageSignature",Mn[Mn.StructuredDataSignature=10]="StructuredDataSignature",Mn[Mn.TransactionAuthField=11]="TransactionAuthField";const ur=BigInt("0xffffffffffffffffffffffffffffffff"),fr=BigInt(0),hr=BigInt("0x7fffffffffffffffffffffffffffffff"),lr=BigInt("-170141183460469231731687303715884105728"),dr=t=>{const n=e(t);if(n<fr)throw new RangeError("Cannot construct unsigned clarity integer from negative value");if(n>ur)throw new RangeError(`Cannot construct unsigned clarity integer greater than ${ur}`);return{type:_n.UInt,value:n}},pr=t=>{if(t.byteLength>1048576)throw new Error("Cannot construct clarity buffer that is greater than 1MB");return{type:_n.Buffer,value:f(t)}},yr=t=>pr(l(t));function gr(t,e,n,r){if(0===r.length)throw Error("Invalid number of public keys");if(!(e!==Q.P2PKH&&e!==Q.P2WPKH||1===r.length&&1===n))throw Error("Invalid number of public keys or signatures");if((e===Q.P2WPKH||e===Q.P2WSH||e===Q.P2WSHNonSequential)&&!r.map((t=>t.data)).every(Fr))throw Error("Public keys must be compressed for segwit");switch(e){case Q.P2PKH:return br(t,kr(r[0].data));case Q.P2WPKH:return br(t,Pr(r[0].data));case Q.P2SH:case Q.P2SHNonSequential:return br(t,Nr(n,r.map(or)));case Q.P2WSH:case Q.P2WSHNonSequential:return br(t,$r(n,r.map(or)))}}function br(t,e){return{type:jn.Address,version:t,hash160:e}}function wr(t){return(0,_.H4)(t.version,t.hash160)}function mr(t){const[e,n,r]=t.split(/\.|::/);var i,o,s;return i=e,o=n,s=r,{type:jn.Asset,address:Wn(i),contractName:qn(o),assetName:qn(s)}}function vr(t){if(t.includes(".")){const[e,n]=t.split(".");return function(t,e){const n=Wn(t),r=qn(e);return{type:jn.Principal,prefix:nt.Contract,address:n,contractName:r}}(e,n)}return function(t){const e=Wn(t);return{type:jn.Principal,prefix:nt.Standard,address:e}}(t)}function Ar(t){const e=Wn(t);return{type:_n.PrincipalStandard,value:wr(e)}}function xr(t){for(const n in t)if(!(/^[a-zA-Z]([a-zA-Z0-9]|[-_!?+<>=/*])*$|^[-+=/*]$|^[<>]=?$/.test(e=n)&&e.length<128))throw new Error(`"${n}" is not a valid Clarity name`);var e;return{type:_n.Tuple,value:t}}function Sr(t){let n;if("string"==typeof t){const e="0x"===t.slice(0,2).toLowerCase();n=new Hn(h(e?t.slice(2):t))}else n=t instanceof Uint8Array?new Hn(t):t;switch(n.readUInt8Enum(Ln,(t=>{throw new mt(`Cannot recognize Clarity Type: ${t}`)}))){case Ln.int:return(t=>{"string"==typeof t&&t.toLowerCase().startsWith("0x")&&(t=c(h(t))),v(t,Uint8Array)&&(t=c(t));const n=e(t);if(n>hr)throw new RangeError(`Cannot construct clarity integer from value greater than ${hr}`);if(n<lr)throw new RangeError(`Cannot construct clarity integer form value less than ${lr}`);return{type:_n.Int,value:n}})(c(n.readBytes(16)));case Ln.uint:return dr(n.readBytes(16));case Ln.buffer:const t=n.readUInt32BE();return pr(n.readBytes(t));case Ln.true:return{type:_n.BoolTrue};case Ln.false:return{type:_n.BoolFalse};case Ln.address:return s=Jn(n),{type:_n.PrincipalStandard,value:wr(s)};case Ln.contract:return function(t,e){if(l(e.content).byteLength>=128)throw new Error("Contract name must be less than 128 bytes");return{type:_n.PrincipalContract,value:`${wr(t)}.${e.content}`}}(Jn(n),tr(n));case Ln.ok:return o=Sr(n),{type:_n.ResponseOk,value:o};case Ln.err:return function(t){return{type:_n.ResponseErr,value:t}}(Sr(n));case Ln.none:return Dn();case Ln.some:return Kn(Sr(n));case Ln.list:const a=n.readUInt32BE(),u=[];for(let t=0;t<a;t++)u.push(Sr(n));return i=u,{type:_n.List,value:i};case Ln.tuple:const f=n.readUInt32BE(),p={};for(let t=0;t<f;t++){const t=tr(n).content;if(void 0===t)throw new mt('"content" is undefined');p[t]=Sr(n)}return xr(p);case Ln.ascii:const g=n.readUInt32BE(),b=y(n.readBytes(g));return r=b,{type:_n.StringASCII,value:r};case Ln.utf8:const w=n.readUInt32BE();return(t=>({type:_n.StringUTF8,value:t}))(d(n.readBytes(w)));default:throw new mt("Unable to deserialize Clarity Value from Uint8Array. Could not find valid Clarity Type.")}var r,i,o,s}const Er=t=>t.length%2?`0${t}`:t,Cr=(t,e)=>t.padEnd(e,"0"),Br=(t,e)=>!!t&&l(t).length>e;function Tr(t){return Nn()(t)}const Ir=t=>rn(Ft(t)),Ur=t=>f(kn(t)),kr=t=>f(Ir(t)),Pr=t=>{const e=Ir(t),n=w(new Uint8Array([0]),new Uint8Array([e.length]),e);return f(Ir(n))},Nr=(t,e)=>{if(t>15||e.length>15)throw Error("P2SH multisig address can only contain up to 15 public keys");const n=[];n.push(80+t),e.forEach((t=>{n.push(t.length),n.push(t)})),n.push(80+e.length),n.push(174);const r=m(n);return f(Ir(r))},$r=(t,e)=>{if(t>15||e.length>15)throw Error("P2WSH multisig address can only contain up to 15 public keys");const n=[];n.push(80+t),e.forEach((t=>{n.push(t.length),n.push(t)})),n.push(80+e.length),n.push(174);const r=m(n),i=Ft(r),o=[];o.push(0),o.push(i.length),o.push(i);const s=m(o);return f(Ir(s))};const Or=t=>{if(t.okay)return Sr(t.result);throw new Error(t.cause)};function Hr(t,e="mainnet"){return e=O(e),function(t,e="mainnet"){e=O(e),t="string"==typeof t?h(t):t;const n=function(t,e){switch(e=O(e??k),t){case Q.P2PKH:switch(e.transactionVersion){case T.Mainnet:return I.MainnetSingleSig;case T.Testnet:return I.TestnetSingleSig;default:throw new Error(`Unexpected transactionVersion ${e.transactionVersion} for hashMode ${t}`)}case Q.P2SH:case Q.P2SHNonSequential:case Q.P2WPKH:case Q.P2WSH:case Q.P2WSHNonSequential:switch(e.transactionVersion){case T.Mainnet:return I.MainnetMultiSig;case T.Testnet:return I.TestnetMultiSig;default:throw new Error(`Unexpected transactionVersion ${e.transactionVersion} for hashMode ${t}`)}default:throw new Error(`Unexpected hashMode ${t}`)}}(Q.P2PKH,e);return wr(br(n,kr(t)))}(Rr(t),e)}function _r(t){return t="string"==typeof t?h(t):t,{type:jn.PublicKey,data:t}}function Lr(t){return"string"==typeof t?t:f(t)}Fe.hmacSha256Sync=(t,...e)=>{const n=Nt.create(Ft,t);return e.forEach((t=>n.update(t))),n.digest()};const jr=Lr;function Mr(t){return("string"==typeof t?t.length/2:t.byteLength)===A}function Fr(t){return!jr(t).startsWith("04")}function Rr(t){const e=Mr(t=De(t));return f(function(t,e=!1){return ce.fromPrivateKey(t).toRawBytes(e)}(t.slice(0,32),e))}const Dr=function(){return(t=Lr(t=Fe.randomPrivateKey())).length==2*A?t:`${t}01`;var t};function Kr(t,e){t=De(t);const[n,i]=function(t,e,n={}){const{seed:r,m:i,d:o}=function(t,e,n){if(null==t)throw new Error(`sign: expected valid message hash, not "${t}"`);const r=xe(t),i=Oe(e),o=[Le(i),_e(r)];if(null!=n){!0===n&&(n=Fe.randomBytes(Jt));const t=xe(n);if(t.length!==Jt)throw new Error(`sign: Expected ${Jt} bytes of extra data`);o.push(t)}return{seed:le(...o),m:He(r),d:i}}(t,e,n.extraEntropy),s=new ke(32,Qt);let a;for(s.reseedSync(r);!(a=$e(s.generateSync(),i,o,n.canonical));)s.reseedSync();return function(t,e){const{sig:n,recovery:r}=t,{der:i,recovered:o}=Object.assign({canonical:!0,der:!0},e),s=i?n.toDERRawBytes():n.toCompactRawBytes();return o?[s,r]:s}(a,n)}(e,t.slice(0,32),{canonical:!0,recovered:!0});if(null==i)throw new Error("No signature recoveryId received");return r(i,1)+he.fromHex(n).toCompactHex()}function Vr(...t){return"number"==typeof t[0]?function(t,e){return e="string"==typeof e?h(e):e,(0,_.H4)(t,f(Ir(e)))}(...t):function(t,e){return e=e?O(e):k,t="string"==typeof t?h(t):t,(0,_.H4)(e.addressVersion.singleSig,f(Ir(t)))}(...t)}function zr(){return{type:jn.MessageSignature,data:f(new Uint8Array(R))}}function qr(t,n,r,i){const o=gr(0,t,1,[_r(n)]).hash160,s=Fr(n)?Y.Compressed:Y.Uncompressed;return{hashMode:t,signer:o,nonce:e(r),fee:e(i),keyEncoding:s,signature:zr()}}function Wr(t){return"signature"in t}function Gr(t){return t===Q.P2SH||t===Q.P2WSH}function Zr(t){const e=Tr(t);return e.nonce=0,e.fee=0,Wr(e)?e.signature=zr():e.fields=[],{...e,nonce:BigInt(0),fee:BigInt(0)}}function Xr(e){return Wr(e)?function(e){return m([e.hashMode,h(e.signer),t(e.nonce,8),t(e.fee,8),e.keyEncoding,ir(e.signature)])}(e):function(e){const n=[e.hashMode,h(e.signer),t(e.nonce,8),t(e.fee,8)],r=Vn(e.fields);n.push(nr(r));const i=new Uint8Array(2);return function(t,e,n=0){t[n+0]=e>>>8,t[n+1]=e>>>0}(i,e.signaturesRequired,0),n.push(i),m(n)}(e)}function Jr(e,n,r,i){const o=e+f(new Uint8Array([n]))+f(t(r,8))+f(t(i,8));if(49!==h(o).byteLength)throw Error("Invalid signature hash length");return Ur(h(o))}function Qr(t,e,n){const r=33+R,i=Fr(e.data)?Y.Compressed:Y.Uncompressed,o=h(t+Er(i.toString(16))+n);if(o.byteLength>r)throw Error("Invalid signature hash length");return Ur(o)}function Yr(t,e,r,i,o,a){const c=Jr(t,e,r,i),u=_r(function(t,e,r=Y.Compressed){const i=function(t){if(t.length<2*Re*2+1)throw new Error("Invalid signature");const e=t.slice(0,2),n=t.slice(2,2+2*Re),r=t.slice(2+2*Re);return{recoveryId:s(e),r:n,s:r}}(e),o=new he(n(i.r),n(i.s)),a=ce.fromSignature(t,o,i.recoveryId),c=r===Y.Compressed;return a.toHex(c)}(c,a,o));return{pubKey:u,nextSigHash:Qr(c,u,a)}}function ti(t){return{authType:J.Standard,spendingCondition:t}}function ei(t,e){return{authType:J.Sponsored,spendingCondition:t,sponsorSpendingCondition:e||qr(Q.P2PKH,"0".repeat(66),0,0)}}function ni(t){if(t.spendingCondition)switch(t.authType){case J.Standard:return ti(Zr(t.spendingCondition));case J.Sponsored:return ei(Zr(t.spendingCondition),function(){const t=qr(Q.P2PKH,"",0,0);return t.signer=(jn.Address,I.MainnetSingleSig,"0".repeat(40)),t.keyEncoding=Y.Compressed,t.signature=zr(),t}());default:throw new At("Unexpected authorization type for signing")}throw new Error("Authorization missing SpendingCondition")}function ri(t,e="hex"){switch(t.type){case _n.BoolTrue:return"true";case _n.BoolFalse:return"false";case _n.Int:return t.value.toString();case _n.UInt:return`u${t.value.toString()}`;case _n.Buffer:if("tryAscii"===e){const e=y(h(t.value));if(/[ -~]/.test(e))return JSON.stringify(e)}return`0x${t.value}`;case _n.OptionalNone:return"none";case _n.OptionalSome:return`(some ${ri(t.value,e)})`;case _n.ResponseErr:return`(err ${ri(t.value,e)})`;case _n.ResponseOk:return`(ok ${ri(t.value,e)})`;case _n.PrincipalStandard:case _n.PrincipalContract:return t.value;case _n.List:return`(list ${t.value.map((t=>ri(t,e))).join(" ")})`;case _n.Tuple:return`(tuple ${Object.keys(t.value).map((n=>`(${n} ${ri(t.value[n],e)})`)).join(" ")})`;case _n.StringASCII:return`"${t.value}"`;case _n.StringUTF8:return`u"${t.value}"`}}function ii(t){switch(t.type){case _n.BoolTrue:case _n.BoolFalse:return"bool";case _n.Int:return"int";case _n.UInt:return"uint";case _n.Buffer:return`(buff ${Math.ceil(t.value.length/2)})`;case _n.OptionalNone:return"(optional none)";case _n.OptionalSome:return`(optional ${ii(t.value)})`;case _n.ResponseErr:return`(response UnknownType ${ii(t.value)})`;case _n.ResponseOk:return`(response ${ii(t.value)} UnknownType)`;case _n.PrincipalStandard:case _n.PrincipalContract:return"principal";case _n.List:return`(list ${t.value.length} ${t.value.length?ii(t.value[0]):"UnknownType"})`;case _n.Tuple:return`(tuple ${Object.keys(t.value).map((e=>`(${e} ${ii(t.value[e])})`)).join(" ")})`;case _n.StringASCII:return`(string-ascii ${p(t.value).length})`;case _n.StringUTF8:return`(string-utf8 ${l(t.value).length})`}}var oi;!function(t){t[t.ClarityAbiTypeUInt128=1]="ClarityAbiTypeUInt128",t[t.ClarityAbiTypeInt128=2]="ClarityAbiTypeInt128",t[t.ClarityAbiTypeBool=3]="ClarityAbiTypeBool",t[t.ClarityAbiTypePrincipal=4]="ClarityAbiTypePrincipal",t[t.ClarityAbiTypeNone=5]="ClarityAbiTypeNone",t[t.ClarityAbiTypeBuffer=6]="ClarityAbiTypeBuffer",t[t.ClarityAbiTypeResponse=7]="ClarityAbiTypeResponse",t[t.ClarityAbiTypeOptional=8]="ClarityAbiTypeOptional",t[t.ClarityAbiTypeTuple=9]="ClarityAbiTypeTuple",t[t.ClarityAbiTypeList=10]="ClarityAbiTypeList",t[t.ClarityAbiTypeStringAscii=11]="ClarityAbiTypeStringAscii",t[t.ClarityAbiTypeStringUtf8=12]="ClarityAbiTypeStringUtf8",t[t.ClarityAbiTypeTraitReference=13]="ClarityAbiTypeTraitReference"}(oi||(oi={}));const si=t=>"string"==typeof t,ai=t=>void 0!==t.buffer,ci=t=>void 0!==t["string-ascii"],ui=t=>void 0!==t["string-utf8"],fi=t=>void 0!==t.response,hi=t=>void 0!==t.optional,li=t=>void 0!==t.tuple,di=t=>void 0!==t.list;function pi(t){if(si(t))return"int128"===t?"int":"uint128"===t?"uint":t;if(ai(t))return`(buff ${t.buffer.length})`;if(ci(t))return`(string-ascii ${t["string-ascii"].length})`;if(ui(t))return`(string-utf8 ${t["string-utf8"].length})`;if(fi(t))return`(response ${pi(t.response.ok)} ${pi(t.response.error)})`;if(hi(t))return`(optional ${pi(t.optional)})`;if(li(t))return`(tuple ${t.tuple.map((t=>`(${t.name} ${pi(t.type)})`)).join(" ")})`;if(di(t))return`(list ${t.list.length} ${pi(t.list.type)})`;throw new Error(`Type string unsupported for Clarity type: ${JSON.stringify(t)}`)}function yi(t,e){const n=function(t){if(si(t)){if("uint128"===t)return{id:oi.ClarityAbiTypeUInt128,type:t};if("int128"===t)return{id:oi.ClarityAbiTypeInt128,type:t};if("bool"===t)return{id:oi.ClarityAbiTypeBool,type:t};if("principal"===t)return{id:oi.ClarityAbiTypePrincipal,type:t};if("trait_reference"===t)return{id:oi.ClarityAbiTypeTraitReference,type:t};if("none"===t)return{id:oi.ClarityAbiTypeNone,type:t};throw new Error(`Unexpected Clarity ABI type primitive: ${JSON.stringify(t)}`)}if(ai(t))return{id:oi.ClarityAbiTypeBuffer,type:t};if(fi(t))return{id:oi.ClarityAbiTypeResponse,type:t};if(hi(t))return{id:oi.ClarityAbiTypeOptional,type:t};if(li(t))return{id:oi.ClarityAbiTypeTuple,type:t};if(di(t))return{id:oi.ClarityAbiTypeList,type:t};if(ci(t))return{id:oi.ClarityAbiTypeStringAscii,type:t};if(ui(t))return{id:oi.ClarityAbiTypeStringUtf8,type:t};throw new Error(`Unexpected Clarity ABI type: ${JSON.stringify(t)}`)}(e);switch(t.type){case _n.BoolTrue:case _n.BoolFalse:return n.id===oi.ClarityAbiTypeBool;case _n.Int:return n.id===oi.ClarityAbiTypeInt128;case _n.UInt:return n.id===oi.ClarityAbiTypeUInt128;case _n.Buffer:return n.id===oi.ClarityAbiTypeBuffer&&n.type.buffer.length>=Math.ceil(t.value.length/2);case _n.StringASCII:return n.id===oi.ClarityAbiTypeStringAscii&&n.type["string-ascii"].length>=t.value.length;case _n.StringUTF8:return n.id===oi.ClarityAbiTypeStringUtf8&&n.type["string-utf8"].length>=t.value.length;case _n.OptionalNone:return n.id===oi.ClarityAbiTypeNone||n.id===oi.ClarityAbiTypeOptional;case _n.OptionalSome:return n.id===oi.ClarityAbiTypeOptional&&yi(t.value,n.type.optional);case _n.ResponseErr:return n.id===oi.ClarityAbiTypeResponse&&yi(t.value,n.type.response.error);case _n.ResponseOk:return n.id===oi.ClarityAbiTypeResponse&&yi(t.value,n.type.response.ok);case _n.PrincipalContract:return n.id===oi.ClarityAbiTypePrincipal||n.id===oi.ClarityAbiTypeTraitReference;case _n.PrincipalStandard:return n.id===oi.ClarityAbiTypePrincipal;case _n.List:return n.id==oi.ClarityAbiTypeList&&n.type.list.length>=t.value.length&&t.value.every((t=>yi(t,n.type.list.type)));case _n.Tuple:if(n.id==oi.ClarityAbiTypeTuple){const e=Tr(t.value);for(let t=0;t<n.type.tuple.length;t++){const r=n.type.tuple[t],i=r.name,o=e[i];if(!o)return!1;if(!yi(o,r.type))return!1;delete e[i]}return!0}return!1;default:return!1}}class gi{constructor({auth:t,payload:n,postConditions:r=Vn([]),postConditionMode:i=Z.Deny,transactionVersion:o,chainId:s,network:a="mainnet"}){a=O(a),this.transactionVersion=o??a.transactionVersion,this.chainId=s??a.chainId,this.auth=t,this.payload="amount"in n?{...n,amount:e(n.amount)}:n,this.postConditionMode=i,this.postConditions=r,this.anchorMode=z.Any}signBegin(){const t=Tr(this);return t.auth=ni(t.auth),t.txid()}verifyBegin(){const t=Tr(this);return t.auth=ni(t.auth),t.txid()}verifyOrigin(){return function(t,e){switch(t.authType){case J.Standard:case J.Sponsored:return function(t,e,n){return Wr(t)?function(t,e,n){const{pubKey:r,nextSigHash:i}=Yr(e,n,t.fee,t.nonce,t.keyEncoding,t.signature.data),o=gr(0,t.hashMode,1,[r]).hash160;if(o!==t.signer)throw new xt(`Signer hash does not equal hash of public key(s): ${o} != ${t.signer}`);return i}(t,e,n):function(t,e,n){const r=[];let i=e,o=!1,s=0;for(const e of t.fields)switch(e.contents.type){case jn.PublicKey:Fr(e.contents.data)||(o=!0),r.push(e.contents);break;case jn.MessageSignature:e.pubKeyEncoding===Y.Uncompressed&&(o=!0);const{pubKey:a,nextSigHash:c}=Yr(i,n,t.fee,t.nonce,e.pubKeyEncoding,e.contents.data);if(Gr(t.hashMode)&&(i=c),r.push(a),s+=1,65536===s)throw new xt("Too many signatures")}if(Gr(t.hashMode)&&s!==t.signaturesRequired||((a=t.hashMode)===Q.P2SHNonSequential||a===Q.P2WSHNonSequential)&&s<t.signaturesRequired)throw new xt("Incorrect number of signatures");var a;if(o&&(t.hashMode===Q.P2WSH||t.hashMode===Q.P2WSHNonSequential))throw new xt("Uncompressed keys are not allowed in this hash mode");const c=gr(0,t.hashMode,t.signaturesRequired,r).hash160;if(c!==t.signer)throw new xt(`Signer hash does not equal hash of public key(s): ${c} != ${t.signer}`);return i}(t,e,n)}(t.spendingCondition,e,J.Standard);default:throw new At("Invalid origin auth type")}}(this.auth,this.verifyBegin())}signNextOrigin(t,e){if(void 0===this.auth.spendingCondition)throw new Error('"auth.spendingCondition" is undefined');if(void 0===this.auth.authType)throw new Error('"auth.authType" is undefined');return this.signAndAppend(this.auth.spendingCondition,t,J.Standard,e)}signNextSponsor(t,e){if(this.auth.authType===J.Sponsored)return this.signAndAppend(this.auth.sponsorSpendingCondition,t,J.Sponsored,e);throw new Error('"auth.sponsorSpendingCondition" is undefined')}appendPubkey(t){const e="object"==typeof t&&"type"in t?t:_r(t),n=this.auth.spendingCondition;if(!n||Wr(n))throw new Error("Can't append public key to a singlesig condition");{const t=Fr(e.data);n.fields.push(Gn(t?Y.Compressed:Y.Uncompressed,e))}}signAndAppend(t,e,n,r){const{nextSig:i,nextSigHash:o}=function(t,e,n,r,i){const o=Jr(t,e,n,r),s=Kr(i,o);return{nextSig:s,nextSigHash:Qr(o,_r(Rr(i)),s)}}(e,n,t.fee,t.nonce,r);if(Wr(t))t.signature=zn(i);else{const e=Mr(r);t.fields.push(Gn(e?Y.Compressed:Y.Uncompressed,zn(i)))}return o}txid(){const t=this.serializeBytes();return Ur(t)}setSponsor(t){if(this.auth.authType!=J.Sponsored)throw new At("Cannot sponsor sign a non-sponsored transaction");this.auth=function(t,n){return{...t,sponsorSpendingCondition:{...n,nonce:e(n.nonce),fee:e(n.fee)}}}(this.auth,t)}setFee(t){this.auth=function(t,n){switch(t.authType){case J.Standard:const r={...t.spendingCondition,fee:e(n)};return{...t,spendingCondition:r};case J.Sponsored:const i={...t.sponsorSpendingCondition,fee:e(n)};return{...t,sponsorSpendingCondition:i}}}(this.auth,t)}setNonce(t){this.auth=function(t,n){const r={...t.spendingCondition,nonce:e(n)};return{...t,spendingCondition:r}}(this.auth,t)}setSponsorNonce(t){if(this.auth.authType!=J.Sponsored)throw new At("Cannot sponsor sign a non-sponsored transaction");this.auth=function(t,n){const r={...t.sponsorSpendingCondition,nonce:e(n)};return{...t,sponsorSpendingCondition:r}}(this.auth,t)}serialize(){return f(this.serializeBytes())}serializeBytes(){if(void 0===this.transactionVersion)throw new wt('"transactionVersion" is undefined');if(void 0===this.chainId)throw new wt('"chainId" is undefined');if(void 0===this.auth)throw new wt('"auth" is undefined');if(void 0===this.payload)throw new wt('"payload" is undefined');const t=[];t.push(this.transactionVersion);const e=new Uint8Array(4);return L(e,this.chainId,0),t.push(e),t.push(function(t){const e=[];switch(e.push(t.authType),t.authType){case J.Standard:e.push(Xr(t.spendingCondition));break;case J.Sponsored:e.push(Xr(t.spendingCondition)),e.push(Xr(t.sponsorSpendingCondition))}return m(e)}(this.auth)),t.push(this.anchorMode),t.push(this.postConditionMode),t.push(nr(this.postConditions)),t.push(rr(this.payload)),m(t)}}function bi(t){return(e=t.transactionVersion,t=>t[e])({[T.Mainnet]:k,[T.Testnet]:P});var e}const wi="/v2/fees/transfer",mi="/v2/fees/transaction",vi="/v2/accounts",Ai="/v2/contracts/interface",xi="/v2/contracts/call-read";const Si={eq:tt.Equal,gt:tt.Greater,lt:tt.Less,gte:tt.GreaterEqual,lte:tt.LessEqual},Ei={sent:et.Sends,"not-sent":et.DoesNotSend};async function Ci(t){const n={fee:BigInt(0),nonce:BigInt(0),network:k,postConditionMode:Z.Deny,sponsored:!1},r=Object.assign(n,t);r.network=O(r.network),r.client=Object.assign({},H(r.network),r.client),r.postConditionMode=function(t){if("number"==typeof t)return t;if("allow"===t)return Z.Allow;if("deny"===t)return Z.Deny;throw new Error(`Invalid post condition mode: ${t}`)}(r.postConditionMode);const i=(o=r.contractAddress,s=r.contractName,a=r.functionName,c=r.functionArgs,"string"==typeof s&&(s=qn(s)),"string"==typeof a&&(a=qn(a)),{type:jn.Payload,payloadType:K.ContractCall,contractAddress:"string"==typeof o?Wn(o):o,contractName:s,functionName:a,functionArgs:c});var o,s,a,c;if(r?.validateWithAbi){let t;if("boolean"==typeof r.validateWithAbi){if(!r?.network)throw new Error("Network option must be provided in order to validate with ABI");t=await async function({contractAddress:t,contractName:e,network:n="mainnet",client:r}){const i=Object.assign({},H(O(n)),r),o=`${i.baseUrl}${Ai}/${t}/${e}`,s=await i.fetch(o);if(!s.ok){const n=await s.text().catch((()=>""));throw new Error(`Error fetching contract ABI for contract "${e}" at address ${t}. Response ${s.status}: ${s.statusText}. Attempted to fetch ${o} and failed with the message: "${n}"`)}return JSON.parse(await s.text())}({...r})}else t=r.validateWithAbi;!function(t,e){const n=e.functions.filter((e=>e.name===t.functionName.content));if(1===n.length){const e=n[0].args;if(t.functionArgs.length!==e.length)throw new Error(`Clarity function expects ${e.length} argument(s) but received ${t.functionArgs.length}`);for(let n=0;n<t.functionArgs.length;n++){const r=t.functionArgs[n],i=e[n];if(!yi(r,i.type)){const e=n+1;throw new Error(`Clarity function \`${t.functionName.content}\` expects argument ${e} to be of type ${pi(i.type)}, not ${ii(r)}`)}}return!0}throw 0===n.length?new Error(`ABI doesn't contain a function with the name ${t.functionName.content}`):new Error(`Malformed ABI. Contains multiple functions with the name ${t.functionName.content}`)}(i,t)}let u=null;if("publicKey"in r)u=qr(Q.P2PKH,r.publicKey,r.nonce,r.fee);else{const t=r.useNonSequentialMultiSig?Q.P2SHNonSequential:Q.P2SH,n=r.address?function(t,e,n,r){if(gr(0,n,e,t.map(_r)).hash160===r)return t;const i=t.slice().sort();if(gr(0,n,e,i.map(_r)).hash160===r)return i;throw new Error("Failed to find matching multi-sig address given public-keys.")}(r.publicKeys.map(jr),r.numSignatures,t,Wn(r.address).hash160):r.publicKeys.map(jr);u=function(t,n,r,i,o){return{hashMode:t,signer:gr(0,t,n,r.map(_r)).hash160,nonce:e(i),fee:e(o),fields:[],signaturesRequired:n}}(t,r.numSignatures,n,r.nonce,r.fee)}const h=r.sponsored?ei(u):ti(u),l=Vn((r.postConditions??[]).map((t=>"string"==typeof t.type?function(t){switch(t.type){case"stx-postcondition":return{type:jn.PostCondition,conditionType:X.STX,principal:"origin"===t.address?{type:jn.Principal,prefix:nt.Origin}:vr(t.address),conditionCode:Si[t.condition],amount:BigInt(t.amount)};case"ft-postcondition":return{type:jn.PostCondition,conditionType:X.Fungible,principal:"origin"===t.address?{type:jn.Principal,prefix:nt.Origin}:vr(t.address),conditionCode:Si[t.condition],amount:BigInt(t.amount),asset:mr(t.asset)};case"nft-postcondition":return{type:jn.PostCondition,conditionType:X.NonFungible,principal:"origin"===t.address?{type:jn.Principal,prefix:nt.Origin}:vr(t.address),conditionCode:Ei[t.condition],asset:mr(t.asset),assetName:t.assetId};default:throw new Error("Invalid post condition type")}}(t):t))),d=new gi({transactionVersion:r.network.transactionVersion,chainId:r.network.chainId,auth:h,payload:i,postConditions:l,postConditionMode:r.postConditionMode});if(void 0===t.fee||null===t.fee){const t=await async function({transaction:t,network:e,client:n}){const r=e??bi(t),i=Object.assign({},H(O(r)),n);try{const e=function(t){const e=t.auth.spendingCondition.hashMode;if([Q.P2SH,Q.P2WSH].includes(e)){const e=t.auth.spendingCondition,n=e.fields.filter((t=>t.contents.type===jn.MessageSignature)).length,r=(e.signaturesRequired-n)*(R+1);return t.serializeBytes().byteLength+r}return t.serializeBytes().byteLength}(t);return(await async function({payload:t,estimatedLength:e,network:n="mainnet",client:r}){const i={transaction_payload:t,estimated_len:e},o={method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(i)},s=Object.assign({},H(O(n)),r),a=`${s.baseUrl}${mi}`,c=await s.fetch(a,o);if(!c.ok){const t=await c.json().catch((()=>({})));if("NoEstimateAvailable"===t?.reason)throw new vt(t?.reason_data?.message??"");throw new Error(`Error estimating transaction fee. Response ${c.status}: ${c.statusText}. Attempted to fetch ${a} and failed with the message: "${t}"`)}return(await c.json()).estimations}({payload:f(rr(t.payload)),estimatedLength:e,network:r,client:i}))[1].fee}catch(e){if(!(e instanceof vt))throw e;return await async function({transaction:t,network:e,client:n}){const r=e??bi(t),i=Object.assign({},H(O(r)),n),o=`${i.baseUrl}${wi}`,s=await i.fetch(o,{headers:{Accept:"application/text"}});if(!s.ok){const t=await s.text().catch((()=>""));throw new Error(`Error estimating transfer fee. Response ${s.status}: ${s.statusText}. Attempted to fetch ${o} and failed with the message: "${t}"`)}const a=await s.text(),c=BigInt(Math.ceil(t.serializeBytes().byteLength));return BigInt(a)*c}({transaction:t,network:r})}}({transaction:d,...r});d.setFee(t)}if(void 0===t.nonce||null===t.nonce){const t=r.network.addressVersion.singleSig,e=(0,_.H4)(t,d.auth.spendingCondition.signer),n=await async function(t){try{return await async function({address:t,network:e="mainnet",client:n}){const r=Object.assign({},H(O(e)),n),i=`${r.baseUrl}/extended/v1/address/${t}/nonces`,o=await r.fetch(i),s=await o.json();return BigInt(s.possible_next_nonce)}(t)}catch(t){}const e=O(t.network??"mainnet"),n=Object.assign({},H(e),t.client),r=`${n.baseUrl}${vi}/${t.address}?proof=0`,i=await n.fetch(r);if(!i.ok){const t=await i.text().catch((()=>""));throw new Error(`Error fetching nonce. Response ${i.status}: ${i.statusText}. Attempted to fetch ${r} and failed with the message: "${t}"`)}const o=await i.json();return BigInt(o.nonce)}({address:e,...r});d.setNonce(n)}return d}function Bi(t){const e=t.split(".");return e.length>2?{subdomain:e[0],name:e[1],namespace:e[2]}:{name:e[0],namespace:e[1]}}const Ti=t=>Ir(l(t));var Ii=Object.defineProperty,Ui=Object.defineProperties,ki=Object.getOwnPropertyDescriptors,Pi=Object.getOwnPropertySymbols,Ni=Object.prototype.hasOwnProperty,$i=Object.prototype.propertyIsEnumerable,Oi=(t,e,n)=>e in t?Ii(t,e,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[e]=n,Hi=(t,e)=>{for(var n in e||(e={}))Ni.call(e,n)&&Oi(t,n,e[n]);if(Pi)for(var n of Pi(e))$i.call(e,n)&&Oi(t,n,e[n]);return t},_i=(t,e)=>Ui(t,ki(e));const Li="bns";async function ji(t){return Ci({contractAddress:t.network.bootAddress,contractName:Li,functionName:t.functionName,functionArgs:t.functionArgs,publicKey:t.publicKey,validateWithAbi:!1,network:t.network,postConditions:t.postConditions})}async function Mi(t){return async function({contractName:t,contractAddress:e,functionName:n,functionArgs:r,senderAddress:i,network:o="mainnet",client:s}){const a={sender:i,arguments:r.map((t=>`0x${f(cr(t))}`))},c={method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(a)},u=encodeURIComponent(n),h=Object.assign({},H(O(o)),s),l=`${h.baseUrl}${xi}/${e}/${t}/${u}`,d=await h.fetch(l,c);if(!d.ok){const t=await d.text().catch((()=>""));throw new Error(`Error calling read-only function. Response ${d.status}: ${d.statusText}. Attempted to fetch ${l} and failed with the message: "${t}"`)}return await d.json().then(Or)}(_i(Hi({},t),{contractAddress:t.network.bootAddress,contractName:Li}))}async function Fi({fullyQualifiedName:t,network:e}){const{subdomain:n,namespace:r,name:i}=Bi(t);if(n)throw new Error("Cannot register a subdomain using registerName");return Mi({functionName:"can-name-be-registered",senderAddress:Hr(Dr()),functionArgs:[yr(r),yr(i)],network:e}).then((t=>t.type===_n.ResponseOk&&t.value.type===_n.BoolTrue))}async function Ri({namespace:t,network:e}){return Mi({functionName:"get-namespace-price",senderAddress:Hr(Dr()),functionArgs:[yr(t)],network:e}).then((t=>{if(t.type===_n.ResponseOk){if(t.value.type===_n.Int||t.value.type===_n.UInt)return BigInt(t.value.value);throw new Error("Response did not contain a number")}throw t.type===_n.ResponseErr?new Error(ri(t.value)):new Error(`Unexpected Clarity Value type: ${ii(t)}`)}))}async function Di({fullyQualifiedName:t,network:e}){const{subdomain:n,namespace:r,name:i}=Bi(t);if(n)throw new Error("Cannot get subdomain name price");return Mi({functionName:"get-name-price",senderAddress:Hr(Dr()),functionArgs:[yr(r),yr(i)],network:e}).then((t=>{if(t.type===_n.ResponseOk){if(t.value.type===_n.Int||t.value.type===_n.UInt)return BigInt(t.value.value);throw new Error("Response did not contain a number")}throw new Error(ri(t.value))}))}async function Ki({namespace:t,salt:n,stxToBurn:r,publicKey:i,network:o}){const s=l(`${t}${n}`),a=Ir(s),c={type:"stx-postcondition",address:Vr(o.addressVersion.singleSig,i),condition:"eq",amount:e(r)};return ji({functionName:"namespace-preorder",functionArgs:[pr(a),dr(r)],publicKey:i,network:o,postConditions:[c]})}async function Vi({namespace:t,salt:e,priceFunction:n,lifetime:r,namespaceImportAddress:i,publicKey:o,network:s}){return ji({functionName:"namespace-reveal",functionArgs:[yr(t),yr(e),dr(n.base),dr(n.coefficient),dr(n.b1),dr(n.b2),dr(n.b3),dr(n.b4),dr(n.b5),dr(n.b6),dr(n.b7),dr(n.b8),dr(n.b9),dr(n.b10),dr(n.b11),dr(n.b12),dr(n.b13),dr(n.b14),dr(n.b15),dr(n.b16),dr(n.nonAlphaDiscount),dr(n.noVowelDiscount),dr(r),Ar(i)],publicKey:o,network:s})}async function zi({namespace:t,name:e,beneficiary:n,zonefile:r,publicKey:i,network:o}){const s=Ti(r);return ji({functionName:"name-import",functionArgs:[yr(t),yr(e),Ar(n),pr(s)],publicKey:i,network:o})}async function qi({namespace:t,publicKey:e,network:n}){return ji({functionName:"namespace-ready",functionArgs:[yr(t)],publicKey:e,network:n})}async function Wi({fullyQualifiedName:t,salt:n,stxToBurn:r,publicKey:i,network:o}){const{subdomain:s}=Bi(t);if(s)throw new Error("Cannot preorder a subdomain using preorderName()");const a=l(`${t}${n}`),c=Ir(a),u={type:"stx-postcondition",address:Vr(o.addressVersion.singleSig,i),condition:"eq",amount:e(r)};return ji({functionName:"name-preorder",functionArgs:[pr(c),dr(r)],publicKey:i,network:o,postConditions:[u]})}async function Gi({fullyQualifiedName:t,salt:e,zonefile:n,publicKey:r,network:i}){const{subdomain:o,namespace:s,name:a}=Bi(t);if(o)throw new Error("Cannot register a subdomain using registerName()");const c=Ti(n);return ji({functionName:"name-register",functionArgs:[yr(s),yr(a),yr(e),pr(c)],network:i,publicKey:r})}async function Zi({fullyQualifiedName:t,zonefile:e,publicKey:n,network:r}){const{subdomain:i,namespace:o,name:s}=Bi(t);if(i)throw new Error("Cannot update a subdomain using updateName()");const a=Ti(e);return ji({functionName:"name-update",functionArgs:[yr(o),yr(s),pr(a)],publicKey:n,network:r})}async function Xi({fullyQualifiedName:t,newOwnerAddress:e,zonefile:n,publicKey:r,network:i}){const{subdomain:o,namespace:s,name:a}=Bi(t);if(o)throw new Error("Cannot transfer a subdomain using transferName()");return ji({functionName:"name-transfer",functionArgs:[yr(s),yr(a),Ar(e),n?Kn(pr(Ti(n))):Dn()],publicKey:r,network:i,postConditions:[{type:"nft-postcondition",address:Vr(i.addressVersion.singleSig,r),condition:"sent",asset:`${i.bootAddress}.bns::names`,assetId:xr({name:yr(a),namespace:yr(s)})},{type:"nft-postcondition",address:e,condition:"not-sent",asset:`${i.bootAddress}.bns::names`,assetId:xr({name:yr(a),namespace:yr(s)})}]})}async function Ji({fullyQualifiedName:t,publicKey:e,network:n}){const{subdomain:r,namespace:i,name:o}=Bi(t);if(r)throw new Error("Cannot revoke a subdomain using revokeName()");return ji({functionName:"name-revoke",functionArgs:[yr(i),yr(o)],publicKey:e,network:n})}async function Qi({fullyQualifiedName:t,stxToBurn:n,newOwnerAddress:r,zonefile:i,publicKey:o,network:s}){const{subdomain:a,namespace:c,name:u}=Bi(t);if(a)throw new Error("Cannot renew a subdomain using renewName()");return ji({functionName:"name-renewal",functionArgs:[yr(c),yr(u),dr(n),r?Kn(Ar(r)):Dn(),i?Kn(pr(Ti(i))):Dn()],publicKey:o,network:s,postConditions:[{type:"stx-postcondition",address:Vr(s.addressVersion.singleSig,o),condition:"eq",amount:e(n)}]})}})(),o})()));
//# sourceMappingURL=index.js.map